{"ast":null,"code":"/*~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~\n\tCopyright (c) 2012 Brett Wejrowski\n\n\twojodesign.com\n\tsimplecartjs.org\n\thttp://github.com/wojodesign/simplecart-js\n\n\tVERSION 3.0.5\n\n\tDual licensed under the MIT or GPL licenses.\n~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~*/\n\n/*jslint browser: true, unparam: true, white: true, nomen: true, regexp: true, maxerr: 50, indent: 4 */\n(function (window, document) {\n  /*global HTMLElement */\n  var typeof_string = typeof \"\",\n      typeof_undefined = typeof undefined,\n      typeof_function = typeof function () {},\n      typeof_object = typeof {},\n      isTypeOf = function isTypeOf(item, type) {\n    return typeof item === type;\n  },\n      isString = function isString(item) {\n    return isTypeOf(item, typeof_string);\n  },\n      isUndefined = function isUndefined(item) {\n    return isTypeOf(item, typeof_undefined);\n  },\n      isFunction = function isFunction(item) {\n    return isTypeOf(item, typeof_function);\n  },\n      isObject = function isObject(item) {\n    return isTypeOf(item, typeof_object);\n  },\n      //Returns true if it is a DOM element\n  isElement = function isElement(o) {\n    return typeof HTMLElement === \"object\" ? o instanceof HTMLElement : typeof o === \"object\" && o.nodeType === 1 && typeof o.nodeName === \"string\";\n  },\n      generateSimpleCart = function generateSimpleCart(space) {\n    // stealing this from selectivizr\n    var selectorEngines = {\n      \"MooTools\": \"$$\",\n      \"Prototype\": \"$$\",\n      \"jQuery\": \"*\"\n    },\n        // local variables for internal use\n    item_id = 0,\n        item_id_namespace = \"SCI-\",\n        sc_items = {},\n        namespace = space || \"simpleCart\",\n        selectorFunctions = {},\n        eventFunctions = {},\n        baseEvents = {},\n        // local references\n    localStorage = window.localStorage,\n        console = window.console || {\n      msgs: [],\n      log: function log(msg) {\n        console.msgs.push(msg);\n      }\n    },\n        // used in views \n    _VALUE_ = 'value',\n        _TEXT_ = 'text',\n        _HTML_ = 'html',\n        _CLICK_ = 'click',\n        // Currencies\n    currencies = {\n      \"USD\": {\n        code: \"USD\",\n        symbol: \"&#36;\",\n        name: \"US Dollar\"\n      },\n      \"AUD\": {\n        code: \"AUD\",\n        symbol: \"&#36;\",\n        name: \"Australian Dollar\"\n      },\n      \"BRL\": {\n        code: \"BRL\",\n        symbol: \"R&#36;\",\n        name: \"Brazilian Real\"\n      },\n      \"CAD\": {\n        code: \"CAD\",\n        symbol: \"&#36;\",\n        name: \"Canadian Dollar\"\n      },\n      \"CZK\": {\n        code: \"CZK\",\n        symbol: \"&nbsp;&#75;&#269;\",\n        name: \"Czech Koruna\",\n        after: true\n      },\n      \"DKK\": {\n        code: \"DKK\",\n        symbol: \"DKK&nbsp;\",\n        name: \"Danish Krone\"\n      },\n      \"EUR\": {\n        code: \"EUR\",\n        symbol: \"&euro;\",\n        name: \"Euro\"\n      },\n      \"HKD\": {\n        code: \"HKD\",\n        symbol: \"&#36;\",\n        name: \"Hong Kong Dollar\"\n      },\n      \"HUF\": {\n        code: \"HUF\",\n        symbol: \"&#70;&#116;\",\n        name: \"Hungarian Forint\"\n      },\n      \"ILS\": {\n        code: \"ILS\",\n        symbol: \"&#8362;\",\n        name: \"Israeli New Sheqel\"\n      },\n      \"JPY\": {\n        code: \"JPY\",\n        symbol: \"&yen;\",\n        name: \"Japanese Yen\",\n        accuracy: 0\n      },\n      \"MXN\": {\n        code: \"MXN\",\n        symbol: \"&#36;\",\n        name: \"Mexican Peso\"\n      },\n      \"NOK\": {\n        code: \"NOK\",\n        symbol: \"NOK&nbsp;\",\n        name: \"Norwegian Krone\"\n      },\n      \"NZD\": {\n        code: \"NZD\",\n        symbol: \"&#36;\",\n        name: \"New Zealand Dollar\"\n      },\n      \"PLN\": {\n        code: \"PLN\",\n        symbol: \"PLN&nbsp;\",\n        name: \"Polish Zloty\"\n      },\n      \"GBP\": {\n        code: \"GBP\",\n        symbol: \"&pound;\",\n        name: \"Pound Sterling\"\n      },\n      \"SGD\": {\n        code: \"SGD\",\n        symbol: \"&#36;\",\n        name: \"Singapore Dollar\"\n      },\n      \"SEK\": {\n        code: \"SEK\",\n        symbol: \"SEK&nbsp;\",\n        name: \"Swedish Krona\"\n      },\n      \"CHF\": {\n        code: \"CHF\",\n        symbol: \"CHF&nbsp;\",\n        name: \"Swiss Franc\"\n      },\n      \"THB\": {\n        code: \"THB\",\n        symbol: \"&#3647;\",\n        name: \"Thai Baht\"\n      },\n      \"BTC\": {\n        code: \"BTC\",\n        symbol: \" BTC\",\n        name: \"Bitcoin\",\n        accuracy: 4,\n        after: true\n      }\n    },\n        // default options\n    settings = {\n      checkout: {\n        type: \"PayPal\",\n        email: \"you@yours.com\"\n      },\n      currency: \"USD\",\n      language: \"english-us\",\n      cartStyle: \"div\",\n      cartColumns: [{\n        attr: \"name\",\n        label: \"Name\"\n      }, {\n        attr: \"price\",\n        label: \"Price\",\n        view: 'currency'\n      }, {\n        view: \"decrement\",\n        label: false\n      }, {\n        attr: \"quantity\",\n        label: \"Qty\"\n      }, {\n        view: \"increment\",\n        label: false\n      }, {\n        attr: \"total\",\n        label: \"SubTotal\",\n        view: 'currency'\n      }, {\n        view: \"remove\",\n        text: \"Remove\",\n        label: false\n      }],\n      excludeFromCheckout: ['thumb'],\n      shippingFlatRate: 0,\n      shippingQuantityRate: 0,\n      shippingTotalRate: 0,\n      shippingCustom: null,\n      taxRate: 0,\n      taxShipping: false,\n      data: {}\n    },\n        // main simpleCart object, function call is used for setting options\n    simpleCart = function simpleCart(options) {\n      // shortcut for simpleCart.ready\n      if (isFunction(options)) {\n        return simpleCart.ready(options);\n      } // set options\n\n\n      if (isObject(options)) {\n        return simpleCart.extend(settings, options);\n      }\n    },\n        // selector engine\n    $engine,\n        // built in cart views for item cells\n    cartColumnViews; // function for extending objects\n\n\n    simpleCart.extend = function (target, opts) {\n      var next;\n\n      if (isUndefined(opts)) {\n        opts = target;\n        target = simpleCart;\n      }\n\n      for (next in opts) {\n        if (Object.prototype.hasOwnProperty.call(opts, next)) {\n          target[next] = opts[next];\n        }\n      }\n\n      return target;\n    }; // create copy function\n\n\n    simpleCart.extend({\n      copy: function copy(n) {\n        var cp = generateSimpleCart(n);\n        cp.init();\n        return cp;\n      }\n    }); // add in the core functionality\n\n    simpleCart.extend({\n      isReady: false,\n      // this is where the magic happens, the add function\n      add: function add(values, opt_quiet) {\n        var info = values || {},\n            newItem = new simpleCart.Item(info),\n            addItem = true,\n            // optionally supress event triggers\n        quiet = opt_quiet === true ? opt_quiet : false,\n            oldItem; // trigger before add event\n\n        if (!quiet) {\n          addItem = simpleCart.trigger('beforeAdd', [newItem]);\n\n          if (addItem === false) {\n            return false;\n          }\n        } // if the new item already exists, increment the value\n\n\n        oldItem = simpleCart.has(newItem);\n\n        if (oldItem) {\n          oldItem.increment(newItem.quantity());\n          newItem = oldItem; // otherwise add the item\n        } else {\n          sc_items[newItem.id()] = newItem;\n        } // update the cart\n\n\n        simpleCart.update();\n\n        if (!quiet) {\n          // trigger after add event\n          simpleCart.trigger('afterAdd', [newItem, isUndefined(oldItem)]);\n        } // return a reference to the added item\n\n\n        return newItem;\n      },\n      // iteration function\n      each: function each(array, callback) {\n        var next,\n            x = 0,\n            result,\n            cb,\n            items;\n\n        if (isFunction(array)) {\n          cb = array;\n          items = sc_items;\n        } else if (isFunction(callback)) {\n          cb = callback;\n          items = array;\n        } else {\n          return;\n        }\n\n        for (next in items) {\n          if (Object.prototype.hasOwnProperty.call(items, next)) {\n            result = cb.call(simpleCart, items[next], x, next);\n\n            if (result === false) {\n              return;\n            }\n\n            x += 1;\n          }\n        }\n      },\n      find: function find(id) {\n        var items = []; // return object for id if it exists\n\n        if (isObject(sc_items[id])) {\n          return sc_items[id];\n        } // search through items with the given criteria\n\n\n        if (isObject(id)) {\n          simpleCart.each(function (item) {\n            var match = true;\n            simpleCart.each(id, function (val, x, attr) {\n              if (isString(val)) {\n                // less than or equal to\n                if (val.match(/<=.*/)) {\n                  val = parseFloat(val.replace('<=', ''));\n\n                  if (!(item.get(attr) && parseFloat(item.get(attr)) <= val)) {\n                    match = false;\n                  } // less than\n\n                } else if (val.match(/</)) {\n                  val = parseFloat(val.replace('<', ''));\n\n                  if (!(item.get(attr) && parseFloat(item.get(attr)) < val)) {\n                    match = false;\n                  } // greater than or equal to\n\n                } else if (val.match(/>=/)) {\n                  val = parseFloat(val.replace('>=', ''));\n\n                  if (!(item.get(attr) && parseFloat(item.get(attr)) >= val)) {\n                    match = false;\n                  } // greater than\n\n                } else if (val.match(/>/)) {\n                  val = parseFloat(val.replace('>', ''));\n\n                  if (!(item.get(attr) && parseFloat(item.get(attr)) > val)) {\n                    match = false;\n                  } // equal to\n\n                } else if (!(item.get(attr) && item.get(attr) === val)) {\n                  match = false;\n                } // equal to non string\n\n              } else if (!(item.get(attr) && item.get(attr) === val)) {\n                match = false;\n              }\n\n              return match;\n            }); // add the item if it matches\n\n            if (match) {\n              items.push(item);\n            }\n          });\n          return items;\n        } // if no criteria is given we return all items\n\n\n        if (isUndefined(id)) {\n          // use a new array so we don't give a reference to the\n          // cart's item array\n          simpleCart.each(function (item) {\n            items.push(item);\n          });\n          return items;\n        } // return empty array as default\n\n\n        return items;\n      },\n      // return all items\n      items: function items() {\n        return this.find();\n      },\n      // check to see if item is in the cart already\n      has: function has(item) {\n        var match = false;\n        simpleCart.each(function (testItem) {\n          if (testItem.equals(item)) {\n            match = testItem;\n          }\n        });\n        return match;\n      },\n      // empty the cart\n      empty: function empty() {\n        // remove each item individually so we see the remove events\n        var newItems = {};\n        simpleCart.each(function (item) {\n          // send a param of true to make sure it doesn't\n          // update after every removal\n          // keep the item if the function returns false,\n          // because we know it has been prevented \n          // from being removed\n          if (item.remove(true) === false) {\n            newItems[item.id()] = item;\n          }\n        });\n        sc_items = newItems;\n        simpleCart.update();\n      },\n      // functions for accessing cart info\n      quantity: function quantity() {\n        var quantity = 0;\n        simpleCart.each(function (item) {\n          quantity += item.quantity();\n        });\n        return quantity;\n      },\n      total: function total() {\n        var total = 0;\n        simpleCart.each(function (item) {\n          total += item.total();\n        });\n        return total;\n      },\n      grandTotal: function grandTotal() {\n        return simpleCart.total() + simpleCart.tax() + simpleCart.shipping();\n      },\n      // updating functions\n      update: function update() {\n        simpleCart.save();\n        simpleCart.trigger(\"update\");\n      },\n      init: function init() {\n        simpleCart.load();\n        simpleCart.update();\n        simpleCart.ready();\n      },\n      // view management\n      $: function $(selector) {\n        return new simpleCart.ELEMENT(selector);\n      },\n      $create: function $create(tag) {\n        return simpleCart.$(document.createElement(tag));\n      },\n      setupViewTool: function setupViewTool() {\n        var members,\n            member,\n            context = window,\n            engine; // Determine the \"best fit\" selector engine\n\n        for (engine in selectorEngines) {\n          if (Object.prototype.hasOwnProperty.call(selectorEngines, engine) && window[engine]) {\n            members = selectorEngines[engine].replace(\"*\", engine).split(\".\");\n            member = members.shift();\n\n            if (member) {\n              context = context[member];\n            }\n\n            if (typeof context === \"function\") {\n              // set the selector engine and extend the prototype of our\n              // element wrapper class\n              $engine = context;\n              simpleCart.extend(simpleCart.ELEMENT._, selectorFunctions[engine]);\n              return;\n            }\n          }\n        }\n      },\n      // return a list of id's in the cart\n      ids: function ids() {\n        var ids = [];\n        simpleCart.each(function (item) {\n          ids.push(item.id());\n        });\n        return ids;\n      },\n      // storage\n      save: function save() {\n        simpleCart.trigger('beforeSave');\n        var items = {}; // save all the items\n\n        simpleCart.each(function (item) {\n          items[item.id()] = simpleCart.extend(item.fields(), item.options());\n        });\n        localStorage.setItem(namespace + \"_items\", JSON.stringify(items));\n        simpleCart.trigger('afterSave');\n      },\n      load: function load() {\n        // empty without the update\n        sc_items = {};\n        var items = localStorage.getItem(namespace + \"_items\");\n\n        if (!items) {\n          return;\n        } // we wrap this in a try statement so we can catch \n        // any json parsing errors. no more stick and we\n        // have a playing card pluckin the spokes now...\n        // soundin like a harley.\n\n\n        try {\n          simpleCart.each(JSON.parse(items), function (item) {\n            simpleCart.add(item, true);\n          });\n        } catch (e) {\n          simpleCart.error(\"Error Loading data: \" + e);\n        }\n\n        simpleCart.trigger('load');\n      },\n      // ready function used as a shortcut for bind('ready',fn)\n      ready: function ready(fn) {\n        if (isFunction(fn)) {\n          // call function if already ready already\n          if (simpleCart.isReady) {\n            fn.call(simpleCart); // bind if not ready\n          } else {\n            simpleCart.bind('ready', fn);\n          } // trigger ready event\n\n        } else if (isUndefined(fn) && !simpleCart.isReady) {\n          simpleCart.trigger('ready');\n          simpleCart.isReady = true;\n        }\n      },\n      error: function error(message) {\n        var msg = \"\";\n\n        if (isString(message)) {\n          msg = message;\n        } else if (isObject(message) && isString(message.message)) {\n          msg = message.message;\n        }\n\n        try {\n          console.log(\"simpleCart(js) Error: \" + msg);\n        } catch (e) {}\n\n        simpleCart.trigger('error', [message]);\n      }\n    });\n    /*******************************************************************\n     *\tTAX AND SHIPPING\n     *******************************************************************/\n\n    simpleCart.extend({\n      // TODO: tax and shipping\n      tax: function tax() {\n        var totalToTax = settings.taxShipping ? simpleCart.total() + simpleCart.shipping() : simpleCart.total(),\n            cost = simpleCart.taxRate() * totalToTax;\n        simpleCart.each(function (item) {\n          if (item.get('tax')) {\n            cost += item.get('tax');\n          } else if (item.get('taxRate')) {\n            cost += item.get('taxRate') * item.total();\n          }\n        });\n        return parseFloat(cost);\n      },\n      taxRate: function taxRate() {\n        return settings.taxRate || 0;\n      },\n      shipping: function shipping(opt_custom_function) {\n        // shortcut to extend options with custom shipping\n        if (isFunction(opt_custom_function)) {\n          simpleCart({\n            shippingCustom: opt_custom_function\n          });\n          return;\n        }\n\n        var cost = settings.shippingQuantityRate * simpleCart.quantity() + settings.shippingTotalRate * simpleCart.total() + settings.shippingFlatRate;\n\n        if (isFunction(settings.shippingCustom)) {\n          cost += settings.shippingCustom.call(simpleCart);\n        }\n\n        simpleCart.each(function (item) {\n          cost += parseFloat(item.get('shipping') || 0);\n        });\n        return parseFloat(cost);\n      }\n    });\n    /*******************************************************************\n     *\tCART VIEWS\n     *******************************************************************/\n    // built in cart views for item cells\n\n    cartColumnViews = {\n      attr: function attr(item, column) {\n        return item.get(column.attr) || \"\";\n      },\n      currency: function currency(item, column) {\n        return simpleCart.toCurrency(item.get(column.attr) || 0);\n      },\n      link: function link(item, column) {\n        return \"<a href='\" + item.get(column.attr) + \"'>\" + column.text + \"</a>\";\n      },\n      decrement: function decrement(item, column) {\n        return \"<a href='javascript:;' class='\" + namespace + \"_decrement'>\" + (column.text || \"-\") + \"</a>\";\n      },\n      increment: function increment(item, column) {\n        return \"<a href='javascript:;' class='\" + namespace + \"_increment'>\" + (column.text || \"+\") + \"</a>\";\n      },\n      image: function image(item, column) {\n        return \"<img src='\" + item.get(column.attr) + \"'/>\";\n      },\n      input: function input(item, column) {\n        return \"<input type='text' value='\" + item.get(column.attr) + \"' class='\" + namespace + \"_input'/>\";\n      },\n      remove: function remove(item, column) {\n        return \"<a href='javascript:;' class='\" + namespace + \"_remove'>\" + (column.text || \"X\") + \"</a>\";\n      }\n    }; // cart column wrapper class and functions\n\n    function cartColumn(opts) {\n      var options = opts || {};\n      return simpleCart.extend({\n        attr: \"\",\n        label: \"\",\n        view: \"attr\",\n        text: \"\",\n        className: \"\",\n        hide: false\n      }, options);\n    }\n\n    function cartCellView(item, column) {\n      var viewFunc = isFunction(column.view) ? column.view : isString(column.view) && isFunction(cartColumnViews[column.view]) ? cartColumnViews[column.view] : cartColumnViews.attr;\n      return viewFunc.call(simpleCart, item, column);\n    }\n\n    simpleCart.extend({\n      // write out cart\n      writeCart: function writeCart(selector) {\n        var TABLE = settings.cartStyle.toLowerCase(),\n            isTable = TABLE === 'table',\n            TR = isTable ? \"tr\" : \"div\",\n            TH = isTable ? 'th' : 'div',\n            TD = isTable ? 'td' : 'div',\n            THEAD = isTable ? 'thead' : 'div',\n            cart_container = simpleCart.$create(TABLE),\n            thead_container = simpleCart.$create(THEAD),\n            header_container = simpleCart.$create(TR).addClass('headerRow'),\n            container = simpleCart.$(selector),\n            column,\n            klass,\n            label,\n            x,\n            xlen;\n        container.html(' ').append(cart_container);\n        cart_container.append(thead_container);\n        thead_container.append(header_container); // create header\n\n        for (x = 0, xlen = settings.cartColumns.length; x < xlen; x += 1) {\n          column = cartColumn(settings.cartColumns[x]);\n          klass = \"item-\" + (column.attr || column.view || column.label || column.text || \"cell\") + \" \" + column.className;\n          label = column.label || \"\"; // append the header cell\n\n          header_container.append(simpleCart.$create(TH).addClass(klass).html(label));\n        } // cycle through the items\n\n\n        simpleCart.each(function (item, y) {\n          simpleCart.createCartRow(item, y, TR, TD, cart_container);\n        });\n        return cart_container;\n      },\n      // generate a cart row from an item\n      createCartRow: function createCartRow(item, y, TR, TD, container) {\n        var row = simpleCart.$create(TR).addClass('itemRow row-' + y + \" \" + (y % 2 ? \"even\" : \"odd\")).attr('id', \"cartItem_\" + item.id()),\n            j,\n            jlen,\n            column,\n            klass,\n            content,\n            cell;\n        container.append(row); // cycle through the columns to create each cell for the item\n\n        for (j = 0, jlen = settings.cartColumns.length; j < jlen; j += 1) {\n          column = cartColumn(settings.cartColumns[j]);\n          klass = \"item-\" + (column.attr || (isString(column.view) ? column.view : column.label || column.text || \"cell\")) + \" \" + column.className;\n          content = cartCellView(item, column);\n          cell = simpleCart.$create(TD).addClass(klass).html(content);\n          row.append(cell);\n        }\n\n        return row;\n      }\n    });\n    /*******************************************************************\n     *\tCART ITEM CLASS MANAGEMENT\n     *******************************************************************/\n\n    simpleCart.Item = function (info) {\n      // we use the data object to track values for the item\n      var _data = {},\n          me = this; // cycle through given attributes and set them to the data object\n\n      if (isObject(info)) {\n        simpleCart.extend(_data, info);\n      } // set the item id\n\n\n      item_id += 1;\n      _data.id = _data.id || item_id_namespace + item_id;\n\n      while (!isUndefined(sc_items[_data.id])) {\n        item_id += 1;\n        _data.id = item_id_namespace + item_id;\n      }\n\n      function checkQuantityAndPrice() {\n        // check to make sure price is valid\n        if (isString(_data.price)) {\n          // trying to remove all chars that aren't numbers or '.'\n          _data.price = parseFloat(_data.price.replace(simpleCart.currency().decimal, \".\").replace(/[^0-9\\.]+/ig, \"\"));\n        }\n\n        if (isNaN(_data.price)) {\n          _data.price = 0;\n        }\n\n        if (_data.price < 0) {\n          _data.price = 0;\n        } // check to make sure quantity is valid\n\n\n        if (isString(_data.quantity)) {\n          _data.quantity = parseInt(_data.quantity.replace(simpleCart.currency().delimiter, \"\"), 10);\n        }\n\n        if (isNaN(_data.quantity)) {\n          _data.quantity = 1;\n        }\n\n        if (_data.quantity <= 0) {\n          me.remove();\n        }\n      } // getter and setter methods to access private variables\n\n\n      me.get = function (name, skipPrototypes) {\n        var usePrototypes = !skipPrototypes;\n\n        if (isUndefined(name)) {\n          return name;\n        } // return the value in order of the data object and then the prototype\n\n\n        return isFunction(_data[name]) ? _data[name].call(me) : !isUndefined(_data[name]) ? _data[name] : isFunction(me[name]) && usePrototypes ? me[name].call(me) : !isUndefined(me[name]) && usePrototypes ? me[name] : _data[name];\n      };\n\n      me.set = function (name, value) {\n        if (!isUndefined(name)) {\n          _data[name.toLowerCase()] = value;\n\n          if (name.toLowerCase() === 'price' || name.toLowerCase() === 'quantity') {\n            checkQuantityAndPrice();\n          }\n        }\n\n        return me;\n      };\n\n      me.equals = function (item) {\n        for (var label in _data) {\n          if (Object.prototype.hasOwnProperty.call(_data, label)) {\n            if (label !== 'quantity' && label !== 'id') {\n              if (item.get(label) !== _data[label]) {\n                return false;\n              }\n            }\n          }\n        }\n\n        return true;\n      };\n\n      me.options = function () {\n        var data = {};\n        simpleCart.each(_data, function (val, x, label) {\n          var add = true;\n          simpleCart.each(me.reservedFields(), function (field) {\n            if (field === label) {\n              add = false;\n            }\n\n            return add;\n          });\n\n          if (add) {\n            data[label] = me.get(label);\n          }\n        });\n        return data;\n      };\n\n      checkQuantityAndPrice();\n    };\n\n    simpleCart.Item._ = simpleCart.Item.prototype = {\n      // editing the item quantity\n      increment: function increment(amount) {\n        var diff = amount || 1;\n        diff = parseInt(diff, 10);\n        this.quantity(this.quantity() + diff);\n\n        if (this.quantity() < 1) {\n          this.remove();\n          return null;\n        }\n\n        return this;\n      },\n      decrement: function decrement(amount) {\n        var diff = amount || 1;\n        return this.increment(-parseInt(diff, 10));\n      },\n      remove: function remove(skipUpdate) {\n        var removeItemBool = simpleCart.trigger(\"beforeRemove\", [sc_items[this.id()]]);\n\n        if (removeItemBool === false) {\n          return false;\n        }\n\n        delete sc_items[this.id()];\n\n        if (!skipUpdate) {\n          simpleCart.update();\n        }\n\n        return null;\n      },\n      // special fields for items\n      reservedFields: function reservedFields() {\n        return ['quantity', 'id', 'item_number', 'price', 'name', 'shipping', 'tax', 'taxRate'];\n      },\n      // return values for all reserved fields if they exist\n      fields: function fields() {\n        var data = {},\n            me = this;\n        simpleCart.each(me.reservedFields(), function (field) {\n          if (me.get(field)) {\n            data[field] = me.get(field);\n          }\n        });\n        return data;\n      },\n      // shortcuts for getter/setters. can\n      // be overwritten for customization\n      // btw, we are hiring at wojo design, and could\n      // use a great web designer. if thats you, you can\n      // get more info at http://wojodesign.com/now-hiring/\n      // or email me directly: brett@wojodesign.com\n      quantity: function quantity(val) {\n        return isUndefined(val) ? parseInt(this.get(\"quantity\", true) || 1, 10) : this.set(\"quantity\", val);\n      },\n      price: function price(val) {\n        return isUndefined(val) ? parseFloat(this.get(\"price\", true).toString().replace(simpleCart.currency().symbol, \"\").replace(simpleCart.currency().delimiter, \"\") || 1) : this.set(\"price\", parseFloat(val.toString().replace(simpleCart.currency().symbol, \"\").replace(simpleCart.currency().delimiter, \"\")));\n      },\n      id: function id() {\n        return this.get('id', false);\n      },\n      total: function total() {\n        return this.quantity() * this.price();\n      }\n    };\n    /*******************************************************************\n     *\tCHECKOUT MANAGEMENT\n     *******************************************************************/\n\n    simpleCart.extend({\n      checkout: function checkout() {\n        if (settings.checkout.type.toLowerCase() === 'custom' && isFunction(settings.checkout.fn)) {\n          settings.checkout.fn.call(simpleCart, settings.checkout);\n        } else if (isFunction(simpleCart.checkout[settings.checkout.type])) {\n          var checkoutData = simpleCart.checkout[settings.checkout.type].call(simpleCart, settings.checkout); // if the checkout method returns data, try to send the form\n\n          if (checkoutData.data && checkoutData.action && checkoutData.method) {\n            // if no one has any objections, send the checkout form\n            if (false !== simpleCart.trigger('beforeCheckout', [checkoutData.data])) {\n              simpleCart.generateAndSendForm(checkoutData);\n            }\n          }\n        } else {\n          simpleCart.error(\"No Valid Checkout Method Specified\");\n        }\n      },\n      extendCheckout: function extendCheckout(methods) {\n        return simpleCart.extend(simpleCart.checkout, methods);\n      },\n      generateAndSendForm: function generateAndSendForm(opts) {\n        var form = simpleCart.$create(\"form\");\n        form.attr('style', 'display:none;');\n        form.attr('action', opts.action);\n        form.attr('method', opts.method);\n        simpleCart.each(opts.data, function (val, x, name) {\n          form.append(simpleCart.$create(\"input\").attr(\"type\", \"hidden\").attr(\"name\", name).val(val));\n        });\n        simpleCart.$(\"body\").append(form);\n        form.el.submit();\n        form.remove();\n      }\n    });\n    simpleCart.extendCheckout({\n      PayPal: function PayPal(opts) {\n        // account email is required\n        if (!opts.email) {\n          return simpleCart.error(\"No email provided for PayPal checkout\");\n        } // build basic form options\n\n\n        var data = {\n          cmd: \"_cart\",\n          upload: \"1\",\n          currency_code: simpleCart.currency().code,\n          business: opts.email,\n          rm: opts.method === \"GET\" ? \"0\" : \"2\",\n          tax_cart: (simpleCart.tax() * 1).toFixed(2),\n          handling_cart: (simpleCart.shipping() * 1).toFixed(2),\n          charset: \"utf-8\"\n        },\n            action = opts.sandbox ? \"https://www.sandbox.paypal.com/cgi-bin/webscr\" : \"https://www.paypal.com/cgi-bin/webscr\",\n            method = opts.method === \"GET\" ? \"GET\" : \"POST\"; // check for return and success URLs in the options\n\n        if (opts.success) {\n          data['return'] = opts.success;\n        }\n\n        if (opts.cancel) {\n          data.cancel_return = opts.cancel;\n        }\n\n        if (opts.notify) {\n          data.notify_url = opts.notify;\n        } // add all the items to the form data\n\n\n        simpleCart.each(function (item, x) {\n          var counter = x + 1,\n              item_options = item.options(),\n              optionCount = 0,\n              send; // basic item data\n\n          data[\"item_name_\" + counter] = item.get(\"name\");\n          data[\"quantity_\" + counter] = item.quantity();\n          data[\"amount_\" + counter] = (item.price() * 1).toFixed(2);\n          data[\"item_number_\" + counter] = item.get(\"item_number\") || counter; // add the options\n\n          simpleCart.each(item_options, function (val, k, attr) {\n            // paypal limits us to 10 options\n            if (k < 10) {\n              // check to see if we need to exclude this from checkout\n              send = true;\n              simpleCart.each(settings.excludeFromCheckout, function (field_name) {\n                if (field_name === attr) {\n                  send = false;\n                }\n              });\n\n              if (send) {\n                optionCount += 1;\n                data[\"on\" + k + \"_\" + counter] = attr;\n                data[\"os\" + k + \"_\" + counter] = val;\n              }\n            }\n          }); // options count\n\n          data[\"option_index_\" + x] = Math.min(10, optionCount);\n        }); // return the data for the checkout form\n\n        return {\n          action: action,\n          method: method,\n          data: data\n        };\n      },\n      GoogleCheckout: function GoogleCheckout(opts) {\n        // account id is required\n        if (!opts.merchantID) {\n          return simpleCart.error(\"No merchant id provided for GoogleCheckout\");\n        } // google only accepts USD and GBP\n\n\n        if (simpleCart.currency().code !== \"USD\" && simpleCart.currency().code !== \"GBP\") {\n          return simpleCart.error(\"Google Checkout only accepts USD and GBP\");\n        } // build basic form options\n\n\n        var data = {\n          // TODO: better shipping support for this google\n          ship_method_name_1: \"Shipping\",\n          ship_method_price_1: simpleCart.shipping(),\n          ship_method_currency_1: simpleCart.currency().code,\n          _charset_: ''\n        },\n            action = \"https://checkout.google.com/api/checkout/v2/checkoutForm/Merchant/\" + opts.merchantID,\n            method = opts.method === \"GET\" ? \"GET\" : \"POST\"; // add items to data\n\n        simpleCart.each(function (item, x) {\n          var counter = x + 1,\n              options_list = [],\n              send;\n          data['item_name_' + counter] = item.get('name');\n          data['item_quantity_' + counter] = item.quantity();\n          data['item_price_' + counter] = item.price();\n          data['item_currency_ ' + counter] = simpleCart.currency().code;\n          data['item_tax_rate' + counter] = item.get('taxRate') || simpleCart.taxRate(); // create array of extra options\n\n          simpleCart.each(item.options(), function (val, x, attr) {\n            // check to see if we need to exclude this from checkout\n            send = true;\n            simpleCart.each(settings.excludeFromCheckout, function (field_name) {\n              if (field_name === attr) {\n                send = false;\n              }\n            });\n\n            if (send) {\n              options_list.push(attr + \": \" + val);\n            }\n          }); // add the options to the description\n\n          data['item_description_' + counter] = options_list.join(\", \");\n        }); // return the data for the checkout form\n\n        return {\n          action: action,\n          method: method,\n          data: data\n        };\n      },\n      AmazonPayments: function AmazonPayments(opts) {\n        // required options\n        if (!opts.merchant_signature) {\n          return simpleCart.error(\"No merchant signature provided for Amazon Payments\");\n        }\n\n        if (!opts.merchant_id) {\n          return simpleCart.error(\"No merchant id provided for Amazon Payments\");\n        }\n\n        if (!opts.aws_access_key_id) {\n          return simpleCart.error(\"No AWS access key id provided for Amazon Payments\");\n        } // build basic form options\n\n\n        var data = {\n          aws_access_key_id: opts.aws_access_key_id,\n          merchant_signature: opts.merchant_signature,\n          currency_code: simpleCart.currency().code,\n          tax_rate: simpleCart.taxRate(),\n          weight_unit: opts.weight_unit || 'lb'\n        },\n            action = \"https://payments\" + (opts.sandbox ? \"-sandbox\" : \"\") + \".amazon.com/checkout/\" + opts.merchant_id,\n            method = opts.method === \"GET\" ? \"GET\" : \"POST\"; // add items to data\n\n        simpleCart.each(function (item, x) {\n          var counter = x + 1,\n              options_list = [];\n          data['item_title_' + counter] = item.get('name');\n          data['item_quantity_' + counter] = item.quantity();\n          data['item_price_' + counter] = item.price();\n          data['item_sku_ ' + counter] = item.get('sku') || item.id();\n          data['item_merchant_id_' + counter] = opts.merchant_id;\n\n          if (item.get('weight')) {\n            data['item_weight_' + counter] = item.get('weight');\n          }\n\n          if (settings.shippingQuantityRate) {\n            data['shipping_method_price_per_unit_rate_' + counter] = settings.shippingQuantityRate;\n          } // create array of extra options\n\n\n          simpleCart.each(item.options(), function (val, x, attr) {\n            // check to see if we need to exclude this from checkout\n            var send = true;\n            simpleCart.each(settings.excludeFromCheckout, function (field_name) {\n              if (field_name === attr) {\n                send = false;\n              }\n            });\n\n            if (send && attr !== 'weight' && attr !== 'tax') {\n              options_list.push(attr + \": \" + val);\n            }\n          }); // add the options to the description\n\n          data['item_description_' + counter] = options_list.join(\", \");\n        }); // return the data for the checkout form\n\n        return {\n          action: action,\n          method: method,\n          data: data\n        };\n      },\n      SendForm: function SendForm(opts) {\n        // url required\n        if (!opts.url) {\n          return simpleCart.error('URL required for SendForm Checkout');\n        } // build basic form options\n\n\n        var data = {\n          currency: simpleCart.currency().code,\n          shipping: simpleCart.shipping(),\n          tax: simpleCart.tax(),\n          taxRate: simpleCart.taxRate(),\n          itemCount: simpleCart.find({}).length\n        },\n            action = opts.url,\n            method = opts.method === \"GET\" ? \"GET\" : \"POST\"; // add items to data\n\n        simpleCart.each(function (item, x) {\n          var counter = x + 1,\n              options_list = [],\n              send;\n          data['item_name_' + counter] = item.get('name');\n          data['item_quantity_' + counter] = item.quantity();\n          data['item_price_' + counter] = item.price(); // create array of extra options\n\n          simpleCart.each(item.options(), function (val, x, attr) {\n            // check to see if we need to exclude this from checkout\n            send = true;\n            simpleCart.each(settings.excludeFromCheckout, function (field_name) {\n              if (field_name === attr) {\n                send = false;\n              }\n            });\n\n            if (send) {\n              options_list.push(attr + \": \" + val);\n            }\n          }); // add the options to the description\n\n          data['item_options_' + counter] = options_list.join(\", \");\n        }); // check for return and success URLs in the options\n\n        if (opts.success) {\n          data['return'] = opts.success;\n        }\n\n        if (opts.cancel) {\n          data.cancel_return = opts.cancel;\n        }\n\n        if (opts.extra_data) {\n          data = simpleCart.extend(data, opts.extra_data);\n        } // return the data for the checkout form\n\n\n        return {\n          action: action,\n          method: method,\n          data: data\n        };\n      }\n    });\n    /*******************************************************************\n     *\tEVENT MANAGEMENT\n     *******************************************************************/\n\n    eventFunctions = {\n      // bind a callback to an event\n      bind: function bind(name, callback) {\n        if (!isFunction(callback)) {\n          return this;\n        }\n\n        if (!this._events) {\n          this._events = {};\n        } // split by spaces to allow for multiple event bindings at once\n\n\n        var eventNameList = name.split(/ +/); // iterate through and bind each event\n\n        simpleCart.each(eventNameList, function (eventName) {\n          if (this._events[eventName] === true) {\n            callback.apply(this);\n          } else if (!isUndefined(this._events[eventName])) {\n            this._events[eventName].push(callback);\n          } else {\n            this._events[eventName] = [callback];\n          }\n        });\n        return this;\n      },\n      // trigger event\n      trigger: function trigger(name, options) {\n        var returnval = true,\n            x,\n            xlen;\n\n        if (!this._events) {\n          this._events = {};\n        }\n\n        if (!isUndefined(this._events[name]) && isFunction(this._events[name][0])) {\n          for (x = 0, xlen = this._events[name].length; x < xlen; x += 1) {\n            returnval = this._events[name][x].apply(this, options || []);\n          }\n        }\n\n        if (returnval === false) {\n          return false;\n        }\n\n        return true;\n      }\n    }; // alias for bind\n\n    eventFunctions.on = eventFunctions.bind;\n    simpleCart.extend(eventFunctions);\n    simpleCart.extend(simpleCart.Item._, eventFunctions); // base simpleCart events in options\n\n    baseEvents = {\n      beforeAdd: null,\n      afterAdd: null,\n      load: null,\n      beforeSave: null,\n      afterSave: null,\n      update: null,\n      ready: null,\n      checkoutSuccess: null,\n      checkoutFail: null,\n      beforeCheckout: null,\n      beforeRemove: null\n    }; // extend with base events\n\n    simpleCart(baseEvents); // bind settings to events\n\n    simpleCart.each(baseEvents, function (val, x, name) {\n      simpleCart.bind(name, function () {\n        if (isFunction(settings[name])) {\n          settings[name].apply(this, arguments);\n        }\n      });\n    });\n    /*******************************************************************\n     *\tFORMATTING FUNCTIONS\n     *******************************************************************/\n\n    simpleCart.extend({\n      toCurrency: function toCurrency(number, opts) {\n        var num = parseFloat(number),\n            opt_input = opts || {},\n            _opts = simpleCart.extend(simpleCart.extend({\n          symbol: \"$\",\n          decimal: \".\",\n          delimiter: \",\",\n          accuracy: 2,\n          after: false\n        }, simpleCart.currency()), opt_input),\n            numParts = num.toFixed(_opts.accuracy).split(\".\"),\n            dec = numParts[1],\n            ints = numParts[0];\n\n        ints = simpleCart.chunk(ints.reverse(), 3).join(_opts.delimiter.reverse()).reverse();\n        return (!_opts.after ? _opts.symbol : \"\") + ints + (dec ? _opts.decimal + dec : \"\") + (_opts.after ? _opts.symbol : \"\");\n      },\n      // break a string in blocks of size n\n      chunk: function chunk(str, n) {\n        if (typeof n === 'undefined') {\n          n = 2;\n        }\n\n        var result = str.match(new RegExp('.{1,' + n + '}', 'g'));\n        return result || [];\n      }\n    }); // reverse string function\n\n    String.prototype.reverse = function () {\n      return this.split(\"\").reverse().join(\"\");\n    }; // currency functions\n\n\n    simpleCart.extend({\n      currency: function currency(_currency) {\n        if (isString(_currency) && !isUndefined(currencies[_currency])) {\n          settings.currency = _currency;\n        } else if (isObject(_currency)) {\n          currencies[_currency.code] = _currency;\n          settings.currency = _currency.code;\n        } else {\n          return currencies[settings.currency];\n        }\n      }\n    });\n    /*******************************************************************\n     *\tVIEW MANAGEMENT\n     *******************************************************************/\n\n    simpleCart.extend({\n      // bind outlets to function\n      bindOutlets: function bindOutlets(outlets) {\n        simpleCart.each(outlets, function (callback, x, selector) {\n          simpleCart.bind('update', function () {\n            simpleCart.setOutlet(\".\" + namespace + \"_\" + selector, callback);\n          });\n        });\n      },\n      // set function return to outlet\n      setOutlet: function setOutlet(selector, func) {\n        var val = func.call(simpleCart, selector);\n\n        if (isObject(val) && val.el) {\n          simpleCart.$(selector).html(' ').append(val);\n        } else if (!isUndefined(val)) {\n          simpleCart.$(selector).html(val);\n        }\n      },\n      // bind click events on inputs\n      bindInputs: function bindInputs(inputs) {\n        simpleCart.each(inputs, function (info) {\n          simpleCart.setInput(\".\" + namespace + \"_\" + info.selector, info.event, info.callback);\n        });\n      },\n      // attach events to inputs\t\n      setInput: function setInput(selector, event, func) {\n        simpleCart.$(selector).live(event, func);\n      }\n    }); // class for wrapping DOM selector shit\n\n    simpleCart.ELEMENT = function (selector) {\n      this.create(selector);\n      this.selector = selector || null; // \"#\" + this.attr('id'); TODO: test length?\n    };\n\n    simpleCart.extend(selectorFunctions, {\n      \"MooTools\": {\n        text: function text(_text) {\n          return this.attr(_TEXT_, _text);\n        },\n        html: function html(_html) {\n          return this.attr(_HTML_, _html);\n        },\n        val: function val(_val) {\n          return this.attr(_VALUE_, _val);\n        },\n        attr: function (_attr) {\n          function attr(_x, _x2) {\n            return _attr.apply(this, arguments);\n          }\n\n          attr.toString = function () {\n            return _attr.toString();\n          };\n\n          return attr;\n        }(function (attr, val) {\n          if (isUndefined(val)) {\n            return this.el[0] && this.el[0].get(attr);\n          }\n\n          this.el.set(attr, val);\n          return this;\n        }),\n        remove: function remove() {\n          this.el.dispose();\n          return null;\n        },\n        addClass: function addClass(klass) {\n          this.el.addClass(klass);\n          return this;\n        },\n        removeClass: function removeClass(klass) {\n          this.el.removeClass(klass);\n          return this;\n        },\n        append: function append(item) {\n          this.el.adopt(item.el);\n          return this;\n        },\n        each: function each(callback) {\n          if (isFunction(callback)) {\n            simpleCart.each(this.el, function (e, i, c) {\n              callback.call(i, i, e, c);\n            });\n          }\n\n          return this;\n        },\n        click: function click(callback) {\n          if (isFunction(callback)) {\n            this.each(function (e) {\n              e.addEvent(_CLICK_, function (ev) {\n                callback.call(e, ev);\n              });\n            });\n          } else if (isUndefined(callback)) {\n            this.el.fireEvent(_CLICK_);\n          }\n\n          return this;\n        },\n        live: function live(event, callback) {\n          var selector = this.selector;\n\n          if (isFunction(callback)) {\n            simpleCart.$(\"body\").el.addEvent(event + \":relay(\" + selector + \")\", function (e, el) {\n              callback.call(el, e);\n            });\n          }\n        },\n        match: function match(selector) {\n          return this.el.match(selector);\n        },\n        parent: function parent() {\n          return simpleCart.$(this.el.getParent());\n        },\n        find: function find(selector) {\n          return simpleCart.$(this.el.getElements(selector));\n        },\n        closest: function closest(selector) {\n          return simpleCart.$(this.el.getParent(selector));\n        },\n        descendants: function descendants() {\n          return this.find(\"*\");\n        },\n        tag: function tag() {\n          return this.el[0].tagName;\n        },\n        submit: function submit() {\n          this.el[0].submit();\n          return this;\n        },\n        create: function create(selector) {\n          this.el = $engine(selector);\n        }\n      },\n      \"Prototype\": {\n        text: function text(_text2) {\n          if (isUndefined(_text2)) {\n            return this.el[0].innerHTML;\n          }\n\n          this.each(function (i, e) {\n            $(e).update(_text2);\n          });\n          return this;\n        },\n        html: function html(_html2) {\n          return this.text(_html2);\n        },\n        val: function val(_val2) {\n          return this.attr(_VALUE_, _val2);\n        },\n        attr: function (_attr2) {\n          function attr(_x3, _x4) {\n            return _attr2.apply(this, arguments);\n          }\n\n          attr.toString = function () {\n            return _attr2.toString();\n          };\n\n          return attr;\n        }(function (attr, val) {\n          if (isUndefined(val)) {\n            return this.el[0].readAttribute(attr);\n          }\n\n          this.each(function (i, e) {\n            $(e).writeAttribute(attr, val);\n          });\n          return this;\n        }),\n        append: function append(item) {\n          this.each(function (i, e) {\n            if (item.el) {\n              item.each(function (i2, e2) {\n                $(e).appendChild(e2);\n              });\n            } else if (isElement(item)) {\n              $(e).appendChild(item);\n            }\n          });\n          return this;\n        },\n        remove: function remove() {\n          this.each(function (i, e) {\n            $(e).remove();\n          });\n          return this;\n        },\n        addClass: function addClass(klass) {\n          this.each(function (i, e) {\n            $(e).addClassName(klass);\n          });\n          return this;\n        },\n        removeClass: function removeClass(klass) {\n          this.each(function (i, e) {\n            $(e).removeClassName(klass);\n          });\n          return this;\n        },\n        each: function each(callback) {\n          if (isFunction(callback)) {\n            simpleCart.each(this.el, function (e, i, c) {\n              callback.call(i, i, e, c);\n            });\n          }\n\n          return this;\n        },\n        click: function click(callback) {\n          if (isFunction(callback)) {\n            this.each(function (i, e) {\n              $(e).observe(_CLICK_, function (ev) {\n                callback.call(e, ev);\n              });\n            });\n          } else if (isUndefined(callback)) {\n            this.each(function (i, e) {\n              $(e).fire(_CLICK_);\n            });\n          }\n\n          return this;\n        },\n        live: function live(event, callback) {\n          if (isFunction(callback)) {\n            var selector = this.selector;\n            document.observe(event, function (e, el) {\n              if (el === $engine(e).findElement(selector)) {\n                callback.call(el, e);\n              }\n            });\n          }\n        },\n        parent: function parent() {\n          return simpleCart.$(this.el.up());\n        },\n        find: function find(selector) {\n          return simpleCart.$(this.el.getElementsBySelector(selector));\n        },\n        closest: function closest(selector) {\n          return simpleCart.$(this.el.up(selector));\n        },\n        descendants: function descendants() {\n          return simpleCart.$(this.el.descendants());\n        },\n        tag: function tag() {\n          return this.el.tagName;\n        },\n        submit: function submit() {\n          this.el[0].submit();\n        },\n        create: function create(selector) {\n          if (isString(selector)) {\n            this.el = $engine(selector);\n          } else if (isElement(selector)) {\n            this.el = [selector];\n          }\n        }\n      },\n      \"jQuery\": {\n        passthrough: function passthrough(action, val) {\n          if (isUndefined(val)) {\n            return this.el[action]();\n          }\n\n          this.el[action](val);\n          return this;\n        },\n        text: function text(_text3) {\n          return this.passthrough(_TEXT_, _text3);\n        },\n        html: function html(_html3) {\n          return this.passthrough(_HTML_, _html3);\n        },\n        val: function val(_val3) {\n          return this.passthrough(\"val\", _val3);\n        },\n        append: function append(item) {\n          var target = item.el || item;\n          this.el.append(target);\n          return this;\n        },\n        attr: function (_attr3) {\n          function attr(_x5, _x6) {\n            return _attr3.apply(this, arguments);\n          }\n\n          attr.toString = function () {\n            return _attr3.toString();\n          };\n\n          return attr;\n        }(function (attr, val) {\n          if (isUndefined(val)) {\n            return this.el.attr(attr);\n          }\n\n          this.el.attr(attr, val);\n          return this;\n        }),\n        remove: function remove() {\n          this.el.remove();\n          return this;\n        },\n        addClass: function addClass(klass) {\n          this.el.addClass(klass);\n          return this;\n        },\n        removeClass: function removeClass(klass) {\n          this.el.removeClass(klass);\n          return this;\n        },\n        each: function each(callback) {\n          return this.passthrough('each', callback);\n        },\n        click: function click(callback) {\n          return this.passthrough(_CLICK_, callback);\n        },\n        live: function live(event, callback) {\n          $engine(document).delegate(this.selector, event, callback);\n          return this;\n        },\n        parent: function parent() {\n          return simpleCart.$(this.el.parent());\n        },\n        find: function find(selector) {\n          return simpleCart.$(this.el.find(selector));\n        },\n        closest: function closest(selector) {\n          return simpleCart.$(this.el.closest(selector));\n        },\n        tag: function tag() {\n          return this.el[0].tagName;\n        },\n        descendants: function descendants() {\n          return simpleCart.$(this.el.find(\"*\"));\n        },\n        submit: function submit() {\n          return this.el.submit();\n        },\n        create: function create(selector) {\n          this.el = $engine(selector);\n        }\n      }\n    });\n    simpleCart.ELEMENT._ = simpleCart.ELEMENT.prototype; // bind the DOM setup to the ready event\n\n    simpleCart.ready(simpleCart.setupViewTool); // bind the input and output events\n\n    simpleCart.ready(function () {\n      simpleCart.bindOutlets({\n        total: function total() {\n          return simpleCart.toCurrency(simpleCart.total());\n        },\n        quantity: function quantity() {\n          return simpleCart.quantity();\n        },\n        items: function items(selector) {\n          simpleCart.writeCart(selector);\n        },\n        tax: function tax() {\n          return simpleCart.toCurrency(simpleCart.tax());\n        },\n        taxRate: function taxRate() {\n          return simpleCart.taxRate().toFixed();\n        },\n        shipping: function shipping() {\n          return simpleCart.toCurrency(simpleCart.shipping());\n        },\n        grandTotal: function grandTotal() {\n          return simpleCart.toCurrency(simpleCart.grandTotal());\n        }\n      });\n      simpleCart.bindInputs([{\n        selector: 'checkout',\n        event: 'click',\n        callback: function callback() {\n          simpleCart.checkout();\n        }\n      }, {\n        selector: 'empty',\n        event: 'click',\n        callback: function callback() {\n          simpleCart.empty();\n        }\n      }, {\n        selector: 'increment',\n        event: 'click',\n        callback: function callback() {\n          simpleCart.find(simpleCart.$(this).closest('.itemRow').attr('id').split(\"_\")[1]).increment();\n          simpleCart.update();\n        }\n      }, {\n        selector: 'decrement',\n        event: 'click',\n        callback: function callback() {\n          simpleCart.find(simpleCart.$(this).closest('.itemRow').attr('id').split(\"_\")[1]).decrement();\n          simpleCart.update();\n        }\n      }\n      /* remove from cart */\n      , {\n        selector: 'remove',\n        event: 'click',\n        callback: function callback() {\n          simpleCart.find(simpleCart.$(this).closest('.itemRow').attr('id').split(\"_\")[1]).remove();\n        }\n      }\n      /* cart inputs */\n      , {\n        selector: 'input',\n        event: 'change',\n        callback: function callback() {\n          var $input = simpleCart.$(this),\n              $parent = $input.parent(),\n              classList = $parent.attr('class').split(\" \");\n          simpleCart.each(classList, function (klass) {\n            if (klass.match(/item-.+/i)) {\n              var field = klass.split(\"-\")[1];\n              simpleCart.find($parent.closest('.itemRow').attr('id').split(\"_\")[1]).set(field, $input.val());\n              simpleCart.update();\n              return;\n            }\n          });\n        }\n      }\n      /* here is our shelfItem add to cart button listener */\n      , {\n        selector: 'shelfItem .item_add',\n        event: 'click',\n        callback: function callback() {\n          var $button = simpleCart.$(this),\n              fields = {};\n          $button.closest(\".\" + namespace + \"_shelfItem\").descendants().each(function (x, item) {\n            var $item = simpleCart.$(item); // check to see if the class matches the item_[fieldname] pattern\n\n            if ($item.attr(\"class\") && $item.attr(\"class\").match(/item_.+/) && !$item.attr('class').match(/item_add/)) {\n              // find the class name\n              simpleCart.each($item.attr('class').split(' '), function (klass) {\n                var attr, val, type; // get the value or text depending on the tagName\n\n                if (klass.match(/item_.+/)) {\n                  attr = klass.split(\"_\")[1];\n                  val = \"\";\n\n                  switch ($item.tag().toLowerCase()) {\n                    case \"input\":\n                    case \"textarea\":\n                    case \"select\":\n                      type = $item.attr(\"type\");\n\n                      if (!type || (type.toLowerCase() === \"checkbox\" || type.toLowerCase() === \"radio\") && $item.attr(\"checked\") || type.toLowerCase() === \"text\" || type.toLowerCase() === \"number\") {\n                        val = $item.val();\n                      }\n\n                      break;\n\n                    case \"img\":\n                      val = $item.attr('src');\n                      break;\n\n                    default:\n                      val = $item.text();\n                      break;\n                  }\n\n                  if (val !== null && val !== \"\") {\n                    fields[attr.toLowerCase()] = fields[attr.toLowerCase()] ? fields[attr.toLowerCase()] + \", \" + val : val;\n                  }\n                }\n              });\n            }\n          }); // add the item\n\n          simpleCart.add(fields);\n        }\n      }]);\n    });\n    /*******************************************************************\n     *\tDOM READY\n     *******************************************************************/\n    // Cleanup functions for the document ready method\n    // used from jQuery\n\n    /*global DOMContentLoaded */\n\n    if (document.addEventListener) {\n      window.DOMContentLoaded = function () {\n        document.removeEventListener(\"DOMContentLoaded\", DOMContentLoaded, false);\n        simpleCart.init();\n      };\n    } else if (document.attachEvent) {\n      window.DOMContentLoaded = function () {\n        // Make sure body exists, at least, in case IE gets a little overzealous (ticket #5443).\n        if (document.readyState === \"complete\") {\n          document.detachEvent(\"onreadystatechange\", DOMContentLoaded);\n          simpleCart.init();\n        }\n      };\n    } // The DOM ready check for Internet Explorer\n    // used from jQuery\n\n\n    function doScrollCheck() {\n      if (simpleCart.isReady) {\n        return;\n      }\n\n      try {\n        // If IE is used, use the trick by Diego Perini\n        // http://javascript.nwbox.com/IEContentLoaded/\n        document.documentElement.doScroll(\"left\");\n      } catch (e) {\n        setTimeout(doScrollCheck, 1);\n        return;\n      } // and execute any waiting functions\n\n\n      simpleCart.init();\n    } // bind ready event used from jquery\n\n\n    function sc_BindReady() {\n      // Catch cases where $(document).ready() is called after the\n      // browser event has already occurred.\n      if (document.readyState === \"complete\") {\n        // Handle it asynchronously to allow scripts the opportunity to delay ready\n        return setTimeout(simpleCart.init, 1);\n      } // Mozilla, Opera and webkit nightlies currently support this event\n\n\n      if (document.addEventListener) {\n        // Use the handy event callback\n        document.addEventListener(\"DOMContentLoaded\", DOMContentLoaded, false); // A fallback to window.onload, that will always work\n\n        window.addEventListener(\"load\", simpleCart.init, false); // If IE event model is used\n      } else if (document.attachEvent) {\n        // ensure firing before onload,\n        // maybe late but safe also for iframes\n        document.attachEvent(\"onreadystatechange\", DOMContentLoaded); // A fallback to window.onload, that will always work\n\n        window.attachEvent(\"onload\", simpleCart.init); // If IE and not a frame\n        // continually check to see if the document is ready\n\n        var toplevel = false;\n\n        try {\n          toplevel = window.frameElement === null;\n        } catch (e) {}\n\n        if (document.documentElement.doScroll && toplevel) {\n          doScrollCheck();\n        }\n      }\n    } // bind the ready event\n\n\n    sc_BindReady();\n    return simpleCart;\n  };\n\n  window.simpleCart = generateSimpleCart();\n})(window, document);\n/************ JSON *************/\n\n\nvar JSON;\nJSON || (JSON = {});\n\n(function () {\n  function k(a) {\n    return a < 10 ? \"0\" + a : a;\n  }\n\n  function o(a) {\n    p.lastIndex = 0;\n    return p.test(a) ? '\"' + a.replace(p, function (a) {\n      var c = r[a];\n      return typeof c === \"string\" ? c : \"\\\\u\" + (\"0000\" + a.charCodeAt(0).toString(16)).slice(-4);\n    }) + '\"' : '\"' + a + '\"';\n  }\n\n  function l(a, j) {\n    var c,\n        d,\n        h,\n        m,\n        g = e,\n        f,\n        b = j[a];\n    b && typeof b === \"object\" && typeof b.toJSON === \"function\" && (b = b.toJSON(a));\n    typeof i === \"function\" && (b = i.call(j, a, b));\n\n    switch (typeof b) {\n      case \"string\":\n        return o(b);\n\n      case \"number\":\n        return isFinite(b) ? String(b) : \"null\";\n\n      case \"boolean\":\n      case \"null\":\n        return String(b);\n\n      case \"object\":\n        if (!b) return \"null\";\n        e += n;\n        f = [];\n\n        if (Object.prototype.toString.apply(b) === \"[object Array]\") {\n          m = b.length;\n\n          for (c = 0; c < m; c += 1) {\n            f[c] = l(c, b) || \"null\";\n          }\n\n          h = f.length === 0 ? \"[]\" : e ? \"[\\n\" + e + f.join(\",\\n\" + e) + \"\\n\" + g + \"]\" : \"[\" + f.join(\",\") + \"]\";\n          e = g;\n          return h;\n        }\n\n        if (i && typeof i === \"object\") {\n          m = i.length;\n\n          for (c = 0; c < m; c += 1) {\n            typeof i[c] === \"string\" && (d = i[c], (h = l(d, b)) && f.push(o(d) + (e ? \": \" : \":\") + h));\n          }\n        } else for (d in b) {\n          Object.prototype.hasOwnProperty.call(b, d) && (h = l(d, b)) && f.push(o(d) + (e ? \": \" : \":\") + h);\n        }\n\n        h = f.length === 0 ? \"{}\" : e ? \"{\\n\" + e + f.join(\",\\n\" + e) + \"\\n\" + g + \"}\" : \"{\" + f.join(\",\") + \"}\";\n        e = g;\n        return h;\n    }\n  }\n\n  if (typeof Date.prototype.toJSON !== \"function\") Date.prototype.toJSON = function () {\n    return isFinite(this.valueOf()) ? this.getUTCFullYear() + \"-\" + k(this.getUTCMonth() + 1) + \"-\" + k(this.getUTCDate()) + \"T\" + k(this.getUTCHours()) + \":\" + k(this.getUTCMinutes()) + \":\" + k(this.getUTCSeconds()) + \"Z\" : null;\n  }, String.prototype.toJSON = Number.prototype.toJSON = Boolean.prototype.toJSON = function () {\n    return this.valueOf();\n  };\n  var q = /[\\u0000\\u00ad\\u0600-\\u0604\\u070f\\u17b4\\u17b5\\u200c-\\u200f\\u2028-\\u202f\\u2060-\\u206f\\ufeff\\ufff0-\\uffff]/g,\n      p = /[\\\\\\\"\\x00-\\x1f\\x7f-\\x9f\\u00ad\\u0600-\\u0604\\u070f\\u17b4\\u17b5\\u200c-\\u200f\\u2028-\\u202f\\u2060-\\u206f\\ufeff\\ufff0-\\uffff]/g,\n      e,\n      n,\n      r = {\n    \"\\b\": \"\\\\b\",\n    \"\\t\": \"\\\\t\",\n    \"\\n\": \"\\\\n\",\n    \"\\f\": \"\\\\f\",\n    \"\\r\": \"\\\\r\",\n    '\"': '\\\\\"',\n    \"\\\\\": \"\\\\\\\\\"\n  },\n      i;\n  if (typeof JSON.stringify !== \"function\") JSON.stringify = function (a, j, c) {\n    var d;\n    n = e = \"\";\n    if (typeof c === \"number\") for (d = 0; d < c; d += 1) {\n      n += \" \";\n    } else typeof c === \"string\" && (n = c);\n    if ((i = j) && typeof j !== \"function\" && (typeof j !== \"object\" || typeof j.length !== \"number\")) throw Error(\"JSON.stringify\");\n    return l(\"\", {\n      \"\": a\n    });\n  };\n  if (typeof JSON.parse !== \"function\") JSON.parse = function (a, e) {\n    function c(a, d) {\n      var g,\n          f,\n          b = a[d];\n      if (b && typeof b === \"object\") for (g in b) {\n        Object.prototype.hasOwnProperty.call(b, g) && (f = c(b, g), f !== void 0 ? b[g] = f : delete b[g]);\n      }\n      return e.call(a, d, b);\n    }\n\n    var d,\n        a = String(a);\n    q.lastIndex = 0;\n    q.test(a) && (a = a.replace(q, function (a) {\n      return \"\\\\u\" + (\"0000\" + a.charCodeAt(0).toString(16)).slice(-4);\n    }));\n    if (/^[\\],:{}\\s]*$/.test(a.replace(/\\\\(?:[\"\\\\\\/bfnrt]|u[0-9a-fA-F]{4})/g, \"@\").replace(/\"[^\"\\\\\\n\\r]*\"|true|false|null|-?\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d+)?/g, \"]\").replace(/(?:^|:|,)(?:\\s*\\[)+/g, \"\"))) return d = eval(\"(\" + a + \")\"), typeof e === \"function\" ? c({\n      \"\": d\n    }, \"\") : d;\n    throw new SyntaxError(\"JSON.parse\");\n  };\n})();\n/************ HTML5 Local Storage Support *************/\n\n\n(function () {\n  if (!this.localStorage) if (this.globalStorage) try {\n    this.localStorage = this.globalStorage;\n  } catch (e) {} else {\n    var a = document.createElement(\"div\");\n    a.style.display = \"none\";\n    document.getElementsByTagName(\"head\")[0].appendChild(a);\n\n    if (a.addBehavior) {\n      a.addBehavior(\"#default#userdata\");\n\n      var d = this.localStorage = {\n        length: 0,\n        setItem: function setItem(b, d) {\n          a.load(\"localStorage\");\n          b = c(b);\n          a.getAttribute(b) || this.length++;\n          a.setAttribute(b, d);\n          a.save(\"localStorage\");\n        },\n        getItem: function getItem(b) {\n          a.load(\"localStorage\");\n          b = c(b);\n          return a.getAttribute(b);\n        },\n        removeItem: function removeItem(b) {\n          a.load(\"localStorage\");\n          b = c(b);\n          a.removeAttribute(b);\n          a.save(\"localStorage\");\n          this.length = 0;\n        },\n        clear: function clear() {\n          a.load(\"localStorage\");\n\n          for (var b = 0; attr = a.XMLDocument.documentElement.attributes[b++];) {\n            a.removeAttribute(attr.name);\n          }\n\n          a.save(\"localStorage\");\n          this.length = 0;\n        },\n        key: function key(b) {\n          a.load(\"localStorage\");\n          return a.XMLDocument.documentElement.attributes[b];\n        }\n      },\n          c = function c(a) {\n        return a.replace(/[^-._0-9A-Za-z\\xb7\\xc0-\\xd6\\xd8-\\xf6\\xf8-\\u037d\\u37f-\\u1fff\\u200c-\\u200d\\u203f\\u2040\\u2070-\\u218f]/g, \"-\");\n      };\n\n      a.load(\"localStorage\");\n      d.length = a.XMLDocument.documentElement.attributes.length;\n    }\n  }\n})();","map":{"version":3,"sources":["/home/sinkline/Sasha san/Wacth_Rails/watch_rails/app/javascript/packs/simpleCart.js"],"names":["window","document","typeof_string","typeof_undefined","undefined","typeof_function","typeof_object","isTypeOf","item","type","isString","isUndefined","isFunction","isObject","isElement","o","HTMLElement","nodeType","nodeName","generateSimpleCart","space","selectorEngines","item_id","item_id_namespace","sc_items","namespace","selectorFunctions","eventFunctions","baseEvents","localStorage","console","msgs","log","msg","push","_VALUE_","_TEXT_","_HTML_","_CLICK_","currencies","code","symbol","name","after","accuracy","settings","checkout","email","currency","language","cartStyle","cartColumns","attr","label","view","text","excludeFromCheckout","shippingFlatRate","shippingQuantityRate","shippingTotalRate","shippingCustom","taxRate","taxShipping","data","simpleCart","options","ready","extend","$engine","cartColumnViews","target","opts","next","Object","prototype","hasOwnProperty","call","copy","n","cp","init","isReady","add","values","opt_quiet","info","newItem","Item","addItem","quiet","oldItem","trigger","has","increment","quantity","id","update","each","array","callback","x","result","cb","items","find","match","val","parseFloat","replace","get","testItem","equals","empty","newItems","remove","total","grandTotal","tax","shipping","save","load","$","selector","ELEMENT","$create","tag","createElement","setupViewTool","members","member","context","engine","split","shift","_","ids","fields","setItem","JSON","stringify","getItem","parse","e","error","fn","bind","message","totalToTax","cost","opt_custom_function","column","toCurrency","link","decrement","image","input","cartColumn","className","hide","cartCellView","viewFunc","writeCart","TABLE","toLowerCase","isTable","TR","TH","TD","THEAD","cart_container","thead_container","header_container","addClass","container","klass","xlen","html","append","length","y","createCartRow","row","j","jlen","content","cell","_data","me","checkQuantityAndPrice","price","decimal","isNaN","parseInt","delimiter","skipPrototypes","usePrototypes","set","value","reservedFields","field","amount","diff","skipUpdate","removeItemBool","toString","checkoutData","action","method","generateAndSendForm","extendCheckout","methods","form","el","submit","PayPal","cmd","upload","currency_code","business","rm","tax_cart","toFixed","handling_cart","charset","sandbox","success","cancel","cancel_return","notify","notify_url","counter","item_options","optionCount","send","k","field_name","Math","min","GoogleCheckout","merchantID","ship_method_name_1","ship_method_price_1","ship_method_currency_1","_charset_","options_list","join","AmazonPayments","merchant_signature","merchant_id","aws_access_key_id","tax_rate","weight_unit","SendForm","url","itemCount","extra_data","_events","eventNameList","eventName","apply","returnval","on","beforeAdd","afterAdd","beforeSave","afterSave","checkoutSuccess","checkoutFail","beforeCheckout","beforeRemove","arguments","number","num","opt_input","_opts","numParts","dec","ints","chunk","reverse","str","RegExp","String","bindOutlets","outlets","setOutlet","func","bindInputs","inputs","setInput","event","live","create","dispose","removeClass","adopt","i","c","click","addEvent","ev","fireEvent","parent","getParent","getElements","closest","descendants","tagName","innerHTML","readAttribute","writeAttribute","i2","e2","appendChild","addClassName","removeClassName","observe","fire","findElement","up","getElementsBySelector","passthrough","delegate","$input","$parent","classList","$button","$item","addEventListener","DOMContentLoaded","removeEventListener","attachEvent","readyState","detachEvent","doScrollCheck","documentElement","doScroll","setTimeout","sc_BindReady","toplevel","frameElement","a","p","lastIndex","test","r","charCodeAt","slice","l","d","h","m","g","f","b","toJSON","isFinite","Date","valueOf","getUTCFullYear","getUTCMonth","getUTCDate","getUTCHours","getUTCMinutes","getUTCSeconds","Number","Boolean","q","Error","eval","SyntaxError","globalStorage","style","display","getElementsByTagName","addBehavior","getAttribute","setAttribute","removeItem","removeAttribute","clear","XMLDocument","attributes","key"],"mappings":"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","sourcesContent":["/*~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~\n\tCopyright (c) 2012 Brett Wejrowski\n\n\twojodesign.com\n\tsimplecartjs.org\n\thttp://github.com/wojodesign/simplecart-js\n\n\tVERSION 3.0.5\n\n\tDual licensed under the MIT or GPL licenses.\n~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~*/\n/*jslint browser: true, unparam: true, white: true, nomen: true, regexp: true, maxerr: 50, indent: 4 */\n\n(function (window, document) {\n\t/*global HTMLElement */\n\n\tvar typeof_string\t\t\t= typeof \"\",\n\t\ttypeof_undefined\t\t= typeof undefined,\n\t\ttypeof_function\t\t\t= typeof function () {},\n\t\ttypeof_object\t\t\t= typeof {},\n\t\tisTypeOf\t\t\t\t= function (item, type) { return typeof item === type; },\n\t\tisString\t\t\t\t= function (item) { return isTypeOf(item, typeof_string); },\n\t\tisUndefined\t\t\t\t= function (item) { return isTypeOf(item, typeof_undefined); },\n\t\tisFunction\t\t\t\t= function (item) { return isTypeOf(item, typeof_function); },\n\n\t\tisObject\t\t\t\t= function (item) { return isTypeOf(item, typeof_object); },\n\t\t//Returns true if it is a DOM element\n\t\tisElement\t\t\t\t= function (o) {\n\t\t\treturn typeof HTMLElement === \"object\" ? o instanceof HTMLElement : typeof o === \"object\" && o.nodeType === 1 && typeof o.nodeName === \"string\";\n\t\t},\n\n\n\n\t\tgenerateSimpleCart = function (space) {\n\n\t\t\t// stealing this from selectivizr\n\t\t\tvar selectorEngines = {\n\t\t\t\t\"MooTools\"\t\t\t\t\t\t\t: \"$$\",\n\t\t\t\t\"Prototype\"\t\t\t\t\t\t\t: \"$$\",\n\t\t\t\t\"jQuery\"\t\t\t\t\t\t\t: \"*\"\n\t\t\t},\n\n\n\t\t\t\t// local variables for internal use\n\t\t\t\titem_id\t\t\t\t\t= 0,\n\t\t\t\titem_id_namespace\t\t= \"SCI-\",\n\t\t\t\tsc_items\t\t\t\t= {},\n\t\t\t\tnamespace\t\t\t\t= space || \"simpleCart\",\n\t\t\t\tselectorFunctions\t\t= {},\n\t\t\t\teventFunctions\t\t\t= {},\n\t\t\t\tbaseEvents\t\t\t\t= {},\n\n\t\t\t\t// local references\n\t\t\t\tlocalStorage\t\t\t= window.localStorage,\n\t\t\t\tconsole\t\t\t\t\t= window.console || { msgs: [], log: function (msg) { console.msgs.push(msg); } },\n\n\t\t\t\t// used in views \n\t\t\t\t_VALUE_\t\t= 'value',\n\t\t\t\t_TEXT_\t\t= 'text',\n\t\t\t\t_HTML_\t\t= 'html',\n\t\t\t\t_CLICK_\t\t= 'click',\n\n\t\t\t\t// Currencies\n\t\t\t\tcurrencies = {\n\t\t\t\t\t\"USD\": { code: \"USD\", symbol: \"&#36;\", name: \"US Dollar\" },\n\t\t\t\t\t\"AUD\": { code: \"AUD\", symbol: \"&#36;\", name: \"Australian Dollar\" },\n\t\t\t\t\t\"BRL\": { code: \"BRL\", symbol: \"R&#36;\", name: \"Brazilian Real\" },\n\t\t\t\t\t\"CAD\": { code: \"CAD\", symbol: \"&#36;\", name: \"Canadian Dollar\" },\n\t\t\t\t\t\"CZK\": { code: \"CZK\", symbol: \"&nbsp;&#75;&#269;\", name: \"Czech Koruna\", after: true },\n\t\t\t\t\t\"DKK\": { code: \"DKK\", symbol: \"DKK&nbsp;\", name: \"Danish Krone\" },\n\t\t\t\t\t\"EUR\": { code: \"EUR\", symbol: \"&euro;\", name: \"Euro\" },\n\t\t\t\t\t\"HKD\": { code: \"HKD\", symbol: \"&#36;\", name: \"Hong Kong Dollar\" },\n\t\t\t\t\t\"HUF\": { code: \"HUF\", symbol: \"&#70;&#116;\", name: \"Hungarian Forint\" },\n\t\t\t\t\t\"ILS\": { code: \"ILS\", symbol: \"&#8362;\", name: \"Israeli New Sheqel\" },\n\t\t\t\t\t\"JPY\": { code: \"JPY\", symbol: \"&yen;\", name: \"Japanese Yen\", accuracy: 0 },\n\t\t\t\t\t\"MXN\": { code: \"MXN\", symbol: \"&#36;\", name: \"Mexican Peso\" },\n\t\t\t\t\t\"NOK\": { code: \"NOK\", symbol: \"NOK&nbsp;\", name: \"Norwegian Krone\" },\n\t\t\t\t\t\"NZD\": { code: \"NZD\", symbol: \"&#36;\", name: \"New Zealand Dollar\" },\n\t\t\t\t\t\"PLN\": { code: \"PLN\", symbol: \"PLN&nbsp;\", name: \"Polish Zloty\" },\n\t\t\t\t\t\"GBP\": { code: \"GBP\", symbol: \"&pound;\", name: \"Pound Sterling\" },\n\t\t\t\t\t\"SGD\": { code: \"SGD\", symbol: \"&#36;\", name: \"Singapore Dollar\" },\n\t\t\t\t\t\"SEK\": { code: \"SEK\", symbol: \"SEK&nbsp;\", name: \"Swedish Krona\" },\n\t\t\t\t\t\"CHF\": { code: \"CHF\", symbol: \"CHF&nbsp;\", name: \"Swiss Franc\" },\n\t\t\t\t\t\"THB\": { code: \"THB\", symbol: \"&#3647;\", name: \"Thai Baht\" },\n\t\t\t\t\t\"BTC\": { code: \"BTC\", symbol: \" BTC\", name: \"Bitcoin\", accuracy: 4, after: true\t}\n\t\t\t\t},\n\n\t\t\t\t// default options\n\t\t\t\tsettings = {\n\t\t\t\t\tcheckout\t\t\t\t: { type: \"PayPal\", email: \"you@yours.com\" },\n\t\t\t\t\tcurrency\t\t\t\t: \"USD\",\n\t\t\t\t\tlanguage\t\t\t\t: \"english-us\",\n\n\t\t\t\t\tcartStyle\t\t\t\t: \"div\",\n\t\t\t\t\tcartColumns\t\t\t: [\n\t\t\t\t\t\t{ attr: \"name\", label: \"Name\" },\n\t\t\t\t\t\t{ attr: \"price\", label: \"Price\", view: 'currency' },\n\t\t\t\t\t\t{ view: \"decrement\", label: false },\n\t\t\t\t\t\t{ attr: \"quantity\", label: \"Qty\" },\n\t\t\t\t\t\t{ view: \"increment\", label: false },\n\t\t\t\t\t\t{ attr: \"total\", label: \"SubTotal\", view: 'currency' },\n\t\t\t\t\t\t{ view: \"remove\", text: \"Remove\", label: false }\n\t\t\t\t\t],\n\n\t\t\t\t\texcludeFromCheckout\t: ['thumb'],\n\n\t\t\t\t\tshippingFlatRate\t\t: 0,\n\t\t\t\t\tshippingQuantityRate\t: 0,\n\t\t\t\t\tshippingTotalRate\t\t: 0,\n\t\t\t\t\tshippingCustom\t\t: null,\n\n\t\t\t\t\ttaxRate\t\t\t\t: 0,\n\t\t\t\t\t\n\t\t\t\t\ttaxShipping\t\t\t: false,\n\n\t\t\t\t\tdata\t\t\t\t: {}\n\n\t\t\t\t},\n\n\n\t\t\t\t// main simpleCart object, function call is used for setting options\n\t\t\t\tsimpleCart = function (options) {\n\t\t\t\t\t// shortcut for simpleCart.ready\n\t\t\t\t\tif (isFunction(options)) {\n\t\t\t\t\t\treturn simpleCart.ready(options);\n\t\t\t\t\t}\n\n\t\t\t\t\t// set options\n\t\t\t\t\tif (isObject(options)) {\n\t\t\t\t\t\treturn simpleCart.extend(settings, options);\n\t\t\t\t\t}\n\t\t\t\t},\n\n\t\t\t\t// selector engine\n\t\t\t\t$engine,\n\n\t\t\t\t// built in cart views for item cells\n\t\t\t\tcartColumnViews;\n\n\t\t\t// function for extending objects\n\t\t\tsimpleCart.extend = function (target, opts) {\n\t\t\t\tvar next;\n\n\t\t\t\tif (isUndefined(opts)) {\n\t\t\t\t\topts = target;\n\t\t\t\t\ttarget = simpleCart;\n\t\t\t\t}\n\n\t\t\t\tfor (next in opts) {\n\t\t\t\t\tif (Object.prototype.hasOwnProperty.call(opts, next)) {\n\t\t\t\t\t\ttarget[next] = opts[next];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn target;\n\t\t\t};\n\n\t\t\t// create copy function\n\t\t\tsimpleCart.extend({\n\t\t\t\tcopy: function (n) {\n\t\t\t\t\tvar cp = generateSimpleCart(n);\n\t\t\t\t\tcp.init();\n\t\t\t\t\treturn cp;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// add in the core functionality\n\t\t\tsimpleCart.extend({\n\n\t\t\t\tisReady: false,\n\n\t\t\t\t// this is where the magic happens, the add function\n\t\t\t\tadd: function (values, opt_quiet) {\n\t\t\t\t\tvar info\t\t= values || {},\n\t\t\t\t\t\tnewItem\t\t= new simpleCart.Item(info),\n\t\t\t\t\t\taddItem \t= true,\n\t\t\t\t\t\t// optionally supress event triggers\n\t\t\t\t\t\tquiet \t\t= opt_quiet === true ? opt_quiet : false,\n\t\t\t\t\t\toldItem;\n\n\t\t\t\t\t// trigger before add event\n\t\t\t\t\tif (!quiet) {\n\t\t\t\t\t  \taddItem = simpleCart.trigger('beforeAdd', [newItem]);\n\t\t\t\t\t\n\t\t\t\t\t\tif (addItem === false) {\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t// if the new item already exists, increment the value\n\t\t\t\t\toldItem = simpleCart.has(newItem);\n\t\t\t\t\tif (oldItem) {\n\t\t\t\t\t\toldItem.increment(newItem.quantity());\n\t\t\t\t\t\tnewItem = oldItem;\n\n\t\t\t\t\t// otherwise add the item\n\t\t\t\t\t} else {\n\t\t\t\t\t\tsc_items[newItem.id()] = newItem;\n\t\t\t\t\t}\n\n\t\t\t\t\t// update the cart\n\t\t\t\t\tsimpleCart.update();\n\n\t\t\t\t\tif (!quiet) {\n\t\t\t\t\t\t// trigger after add event\n\t\t\t\t\t\tsimpleCart.trigger('afterAdd', [newItem, isUndefined(oldItem)]);\n\t\t\t\t\t}\n\n\t\t\t\t\t// return a reference to the added item\n\t\t\t\t\treturn newItem;\n\t\t\t\t},\n\n\n\t\t\t\t// iteration function\n\t\t\t\teach: function (array, callback) {\n\t\t\t\t\tvar next,\n\t\t\t\t\t\tx = 0,\n\t\t\t\t\t\tresult,\n\t\t\t\t\t\tcb,\n\t\t\t\t\t\titems;\n\n\t\t\t\t\tif (isFunction(array)) {\n\t\t\t\t\t\tcb = array;\n\t\t\t\t\t\titems = sc_items;\n\t\t\t\t\t} else if (isFunction(callback)) {\n\t\t\t\t\t\tcb = callback;\n\t\t\t\t\t\titems = array;\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tfor (next in items) {\n\t\t\t\t\t\tif (Object.prototype.hasOwnProperty.call(items, next)) {\n\t\t\t\t\t\t\tresult = cb.call(simpleCart, items[next], x, next);\n\t\t\t\t\t\t\tif (result === false) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tx += 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\n\t\t\t\tfind: function (id) {\n\t\t\t\t\tvar items = [];\n\n\t\t\t\t\t// return object for id if it exists\n\t\t\t\t\tif (isObject(sc_items[id])) {\n\t\t\t\t\t\treturn sc_items[id];\n\t\t\t\t\t}\n\t\t\t\t\t// search through items with the given criteria\n\t\t\t\t\tif (isObject(id)) {\n\t\t\t\t\t\tsimpleCart.each(function (item) {\n\t\t\t\t\t\t\tvar match = true;\n\t\t\t\t\t\t\tsimpleCart.each(id, function (val, x, attr) {\n\n\t\t\t\t\t\t\t\tif (isString(val)) {\n\t\t\t\t\t\t\t\t\t// less than or equal to\n\t\t\t\t\t\t\t\t\tif (val.match(/<=.*/)) {\n\t\t\t\t\t\t\t\t\t\tval = parseFloat(val.replace('<=', ''));\n\t\t\t\t\t\t\t\t\t\tif (!(item.get(attr) && parseFloat(item.get(attr)) <= val)) {\n\t\t\t\t\t\t\t\t\t\t\tmatch = false;\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t// less than\n\t\t\t\t\t\t\t\t\t} else if (val.match(/</)) {\n\t\t\t\t\t\t\t\t\t\tval = parseFloat(val.replace('<', ''));\n\t\t\t\t\t\t\t\t\t\tif (!(item.get(attr) && parseFloat(item.get(attr)) < val)) {\n\t\t\t\t\t\t\t\t\t\t\tmatch = false;\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t// greater than or equal to\n\t\t\t\t\t\t\t\t\t} else if (val.match(/>=/)) {\n\t\t\t\t\t\t\t\t\t\tval = parseFloat(val.replace('>=', ''));\n\t\t\t\t\t\t\t\t\t\tif (!(item.get(attr) && parseFloat(item.get(attr)) >= val)) {\n\t\t\t\t\t\t\t\t\t\t\tmatch = false;\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t// greater than\n\t\t\t\t\t\t\t\t\t} else if (val.match(/>/)) {\n\t\t\t\t\t\t\t\t\t\tval = parseFloat(val.replace('>', ''));\n\t\t\t\t\t\t\t\t\t\tif (!(item.get(attr) && parseFloat(item.get(attr)) > val)) {\n\t\t\t\t\t\t\t\t\t\t\tmatch = false;\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t// equal to\n\t\t\t\t\t\t\t\t\t} else if (!(item.get(attr) && item.get(attr) === val)) {\n\t\t\t\t\t\t\t\t\t\tmatch = false;\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t// equal to non string\n\t\t\t\t\t\t\t\t} else if (!(item.get(attr) && item.get(attr) === val)) {\n\t\t\t\t\t\t\t\t\tmatch = false;\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\treturn match;\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t// add the item if it matches\n\t\t\t\t\t\t\tif (match) {\n\t\t\t\t\t\t\t\titems.push(item);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn items;\n\t\t\t\t\t}\n\n\t\t\t\t\t// if no criteria is given we return all items\n\t\t\t\t\tif (isUndefined(id)) {\n\n\t\t\t\t\t\t// use a new array so we don't give a reference to the\n\t\t\t\t\t\t// cart's item array\n\t\t\t\t\t\tsimpleCart.each(function (item) {\n\t\t\t\t\t\t\titems.push(item);\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn items;\n\t\t\t\t\t}\n\n\t\t\t\t\t// return empty array as default\n\t\t\t\t\treturn items;\n\t\t\t\t},\n\n\t\t\t\t// return all items\n\t\t\t\titems: function () {\n\t\t\t\t\treturn this.find();\n\t\t\t\t},\n\n\t\t\t\t// check to see if item is in the cart already\n\t\t\t\thas: function (item) {\n\t\t\t\t\tvar match = false;\n\n\t\t\t\t\tsimpleCart.each(function (testItem) {\n\t\t\t\t\t\tif (testItem.equals(item)) {\n\t\t\t\t\t\t\tmatch = testItem;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\treturn match;\n\t\t\t\t},\n\n\t\t\t\t// empty the cart\n\t\t\t\tempty: function () {\n\t\t\t\t\t// remove each item individually so we see the remove events\n\t\t\t\t\tvar newItems = {};\n\t\t\t\t\tsimpleCart.each(function (item) {\n\t\t\t\t\t\t// send a param of true to make sure it doesn't\n\t\t\t\t\t\t// update after every removal\n\t\t\t\t\t\t// keep the item if the function returns false,\n\t\t\t\t\t\t// because we know it has been prevented \n\t\t\t\t\t\t// from being removed\n\t\t\t\t\t\tif (item.remove(true) === false) {\n\t\t\t\t\t\t\tnewItems[item.id()] = item\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tsc_items = newItems;\n\t\t\t\t\tsimpleCart.update();\n\t\t\t\t},\n\n\n\t\t\t\t// functions for accessing cart info\n\t\t\t\tquantity: function () {\n\t\t\t\t\tvar quantity = 0;\n\t\t\t\t\tsimpleCart.each(function (item) {\n\t\t\t\t\t\tquantity += item.quantity();\n\t\t\t\t\t});\n\t\t\t\t\treturn quantity;\n\t\t\t\t},\n\n\t\t\t\ttotal: function () {\n\t\t\t\t\tvar total = 0;\n\t\t\t\t\tsimpleCart.each(function (item) {\n\t\t\t\t\t\ttotal += item.total();\n\t\t\t\t\t});\n\t\t\t\t\treturn total;\n\t\t\t\t},\n\n\t\t\t\tgrandTotal: function () {\n\t\t\t\t\treturn simpleCart.total() + simpleCart.tax() + simpleCart.shipping();\n\t\t\t\t},\n\n\n\t\t\t\t// updating functions\n\t\t\t\tupdate: function () {\n\t\t\t\t\tsimpleCart.save();\n\t\t\t\t\tsimpleCart.trigger(\"update\");\n\t\t\t\t},\n\n\t\t\t\tinit: function () {\n\t\t\t\t\tsimpleCart.load();\n\t\t\t\t\tsimpleCart.update();\n\t\t\t\t\tsimpleCart.ready();\n\t\t\t\t},\n\n\t\t\t\t// view management\n\t\t\t\t$: function (selector) {\n\t\t\t\t\treturn new simpleCart.ELEMENT(selector);\n\t\t\t\t},\n\n\t\t\t\t$create: function (tag) {\n\t\t\t\t\treturn simpleCart.$(document.createElement(tag));\n\t\t\t\t},\n\n\t\t\t\tsetupViewTool: function () {\n\t\t\t\t\tvar members, member, context = window, engine;\n\n\t\t\t\t\t// Determine the \"best fit\" selector engine\n\t\t\t\t\tfor (engine in selectorEngines) {\n\t\t\t\t\t\tif (Object.prototype.hasOwnProperty.call(selectorEngines, engine) && window[engine]) {\n\t\t\t\t\t\t\tmembers = selectorEngines[engine].replace(\"*\", engine).split(\".\");\n\t\t\t\t\t\t\tmember = members.shift();\n\t\t\t\t\t\t\tif (member) {\n\t\t\t\t\t\t\t\tcontext = context[member];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (typeof context === \"function\") {\n\t\t\t\t\t\t\t\t// set the selector engine and extend the prototype of our\n\t\t\t\t\t\t\t\t// element wrapper class\n\t\t\t\t\t\t\t\t$engine = context;\n\t\t\t\t\t\t\t\tsimpleCart.extend(simpleCart.ELEMENT._, selectorFunctions[engine]);\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\n\t\t\t\t// return a list of id's in the cart\n\t\t\t\tids: function () {\n\t\t\t\t\tvar ids = [];\n\t\t\t\t\tsimpleCart.each(function (item) {\n\t\t\t\t\t\tids.push(item.id());\n\t\t\t\t\t});\n\t\t\t\t\treturn ids;\n\n\t\t\t\t},\n\n\n\t\t\t\t// storage\n\t\t\t\tsave: function () {\n\t\t\t\t\tsimpleCart.trigger('beforeSave');\n\n\t\t\t\t\tvar items = {};\n\n\t\t\t\t\t// save all the items\n\t\t\t\t\tsimpleCart.each(function (item) {\n\t\t\t\t\t\titems[item.id()] = simpleCart.extend(item.fields(), item.options());\n\t\t\t\t\t});\n\n\t\t\t\t\tlocalStorage.setItem(namespace + \"_items\", JSON.stringify(items));\n\n\t\t\t\t\tsimpleCart.trigger('afterSave');\n\t\t\t\t},\n\n\t\t\t\tload: function () {\n\n\t\t\t\t\t// empty without the update\n\t\t\t\t\tsc_items = {};\n\n\t\t\t\t\tvar items = localStorage.getItem(namespace + \"_items\");\n\n\t\t\t\t\tif (!items) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t// we wrap this in a try statement so we can catch \n\t\t\t\t\t// any json parsing errors. no more stick and we\n\t\t\t\t\t// have a playing card pluckin the spokes now...\n\t\t\t\t\t// soundin like a harley.\n\t\t\t\t\ttry {\n\t\t\t\t\t\tsimpleCart.each(JSON.parse(items), function (item) {\n\t\t\t\t\t\t\tsimpleCart.add(item, true);\n\t\t\t\t\t\t});\n\t\t\t\t\t} catch (e){\n\t\t\t\t\t\tsimpleCart.error( \"Error Loading data: \" + e );\n\t\t\t\t\t}\n\n\n\t\t\t\t\tsimpleCart.trigger('load');\n\t\t\t\t},\n\n\t\t\t\t// ready function used as a shortcut for bind('ready',fn)\n\t\t\t\tready: function (fn) {\n\n\t\t\t\t\tif (isFunction(fn)) {\n\t\t\t\t\t\t// call function if already ready already\n\t\t\t\t\t\tif (simpleCart.isReady) {\n\t\t\t\t\t\t\tfn.call(simpleCart);\n\n\t\t\t\t\t\t// bind if not ready\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tsimpleCart.bind('ready', fn);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t// trigger ready event\n\t\t\t\t\t} else if (isUndefined(fn) && !simpleCart.isReady) {\n\t\t\t\t\t\tsimpleCart.trigger('ready');\n\t\t\t\t\t\tsimpleCart.isReady = true;\n\t\t\t\t\t}\n\n\t\t\t\t},\n\n\n\t\t\t\terror: function (message) {\n\t\t\t\t\tvar msg = \"\";\n\t\t\t\t\tif (isString(message)) {\n\t\t\t\t\t\tmsg = message;\n\t\t\t\t\t} else if (isObject(message) && isString(message.message)) {\n\t\t\t\t\t\tmsg = message.message;\n\t\t\t\t\t}\n\t\t\t\t\ttry { console.log(\"simpleCart(js) Error: \" + msg); } catch (e) {}\n\t\t\t\t\tsimpleCart.trigger('error', [message]);\n\t\t\t\t}\n\t\t\t});\n\n\n\t\t\t/*******************************************************************\n\t\t\t *\tTAX AND SHIPPING\n\t\t\t *******************************************************************/\n\t\t\tsimpleCart.extend({\n\n\t\t\t\t// TODO: tax and shipping\n\t\t\t\ttax: function () {\n\t\t\t\t\tvar totalToTax = settings.taxShipping ? simpleCart.total() + simpleCart.shipping() : simpleCart.total(),\n\t\t\t\t\t\tcost = simpleCart.taxRate() * totalToTax;\n\t\t\t\t\t\n\t\t\t\t\tsimpleCart.each(function (item) {\n\t\t\t\t\t\tif (item.get('tax')) {\n\t\t\t\t\t\t\tcost += item.get('tax');\n\t\t\t\t\t\t} else if (item.get('taxRate')) {\n\t\t\t\t\t\t\tcost += item.get('taxRate') * item.total();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\treturn parseFloat(cost);\n\t\t\t\t},\n\t\t\t\t\n\t\t\t\ttaxRate: function () {\n\t\t\t\t\treturn settings.taxRate || 0;\n\t\t\t\t},\n\n\t\t\t\tshipping: function (opt_custom_function) {\n\n\t\t\t\t\t// shortcut to extend options with custom shipping\n\t\t\t\t\tif (isFunction(opt_custom_function)) {\n\t\t\t\t\t\tsimpleCart({\n\t\t\t\t\t\t\tshippingCustom: opt_custom_function\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tvar cost = settings.shippingQuantityRate * simpleCart.quantity() +\n\t\t\t\t\t\t\tsettings.shippingTotalRate * simpleCart.total() +\n\t\t\t\t\t\t\tsettings.shippingFlatRate;\n\n\t\t\t\t\tif (isFunction(settings.shippingCustom)) {\n\t\t\t\t\t\tcost += settings.shippingCustom.call(simpleCart);\n\t\t\t\t\t}\n\n\t\t\t\t\tsimpleCart.each(function (item) {\n\t\t\t\t\t\tcost += parseFloat(item.get('shipping') || 0);\n\t\t\t\t\t});\n\t\t\t\t\treturn parseFloat(cost);\n\t\t\t\t}\n\n\t\t\t});\n\n\t\t\t/*******************************************************************\n\t\t\t *\tCART VIEWS\n\t\t\t *******************************************************************/\n\n\t\t\t// built in cart views for item cells\n\t\t\tcartColumnViews = {\n\t\t\t\tattr: function (item, column) {\n\t\t\t\t\treturn item.get(column.attr) || \"\";\n\t\t\t\t},\n\n\t\t\t\tcurrency: function (item, column) {\n\t\t\t\t\treturn simpleCart.toCurrency(item.get(column.attr) || 0);\n\t\t\t\t},\n\n\t\t\t\tlink: function (item, column) {\n\t\t\t\t\treturn \"<a href='\" + item.get(column.attr) + \"'>\" + column.text + \"</a>\";\n\t\t\t\t},\n\n\t\t\t\tdecrement: function (item, column) {\n\t\t\t\t\treturn \"<a href='javascript:;' class='\" + namespace + \"_decrement'>\" + (column.text || \"-\") + \"</a>\";\n\t\t\t\t},\n\n\t\t\t\tincrement: function (item, column) {\n\t\t\t\t\treturn \"<a href='javascript:;' class='\" + namespace + \"_increment'>\" + (column.text || \"+\") + \"</a>\";\n\t\t\t\t},\n\n\t\t\t\timage: function (item, column) {\n\t\t\t\t\treturn \"<img src='\" + item.get(column.attr) + \"'/>\";\n\t\t\t\t},\n\n\t\t\t\tinput: function (item, column) {\n\t\t\t\t\treturn \"<input type='text' value='\" + item.get(column.attr) + \"' class='\" + namespace + \"_input'/>\";\n\t\t\t\t},\n\n\t\t\t\tremove: function (item, column) {\n\t\t\t\t\treturn \"<a href='javascript:;' class='\" + namespace + \"_remove'>\" + (column.text || \"X\") + \"</a>\";\n\t\t\t\t}\n\t\t\t};\n\n\t\t\t// cart column wrapper class and functions\n\t\t\tfunction cartColumn(opts) {\n\t\t\t\tvar options = opts || {};\n\t\t\t\treturn simpleCart.extend({\n\t\t\t\t\tattr\t\t\t: \"\",\n\t\t\t\t\tlabel\t\t\t: \"\",\n\t\t\t\t\tview\t\t\t: \"attr\",\n\t\t\t\t\ttext\t\t\t: \"\",\n\t\t\t\t\tclassName\t\t: \"\",\n\t\t\t\t\thide\t\t\t: false\n\t\t\t\t}, options);\n\t\t\t}\n\n\t\t\tfunction cartCellView(item, column) {\n\t\t\t\tvar viewFunc = isFunction(column.view) ? column.view : isString(column.view) && isFunction(cartColumnViews[column.view]) ? cartColumnViews[column.view] : cartColumnViews.attr;\n\n\t\t\t\treturn viewFunc.call(simpleCart, item, column);\n\t\t\t}\n\n\n\t\t\tsimpleCart.extend({\n\n\t\t\t\t// write out cart\n\t\t\t\twriteCart: function (selector) {\n\t\t\t\t\tvar TABLE = settings.cartStyle.toLowerCase(),\n\t\t\t\t\t\tisTable = TABLE === 'table',\n\t\t\t\t\t\tTR = isTable ? \"tr\" : \"div\",\n\t\t\t\t\t\tTH = isTable ? 'th' : 'div',\n\t\t\t\t\t\tTD = isTable ? 'td' : 'div',\n\t\t\t\t\t\tTHEAD = isTable ? 'thead' : 'div',\n\t\t\t\t\t\tcart_container = simpleCart.$create(TABLE),\n\t\t\t\t\t\tthead_container = simpleCart.$create(THEAD),\n\t\t\t\t\t\theader_container = simpleCart.$create(TR).addClass('headerRow'),\n\t\t\t\t\t\tcontainer = simpleCart.$(selector),\n\t\t\t\t\t\tcolumn,\n\t\t\t\t\t\tklass,\n\t\t\t\t\t\tlabel,\n\t\t\t\t\t\tx,\n\t\t\t\t\t\txlen;\n\n\t\t\t\t\tcontainer.html(' ').append(cart_container);\n\n\t\t\t\t\tcart_container.append(thead_container);\n\n\t\t\t\t\tthead_container.append(header_container);\n\n\n\t\t\t\t\t// create header\n\t\t\t\t\tfor (x = 0, xlen = settings.cartColumns.length; x < xlen; x += 1) {\n\t\t\t\t\t\tcolumn\t= cartColumn(settings.cartColumns[x]);\n\t\t\t\t\t\tklass\t=  \"item-\" + (column.attr || column.view || column.label || column.text || \"cell\") + \" \" + column.className;\n\t\t\t\t\t\tlabel\t= column.label || \"\";\n\n\t\t\t\t\t\t// append the header cell\n\t\t\t\t\t\theader_container.append(\n\t\t\t\t\t\t\tsimpleCart.$create(TH).addClass(klass).html(label)\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\n\t\t\t\t\t// cycle through the items\n\t\t\t\t\tsimpleCart.each(function (item, y) {\n\t\t\t\t\t\tsimpleCart.createCartRow(item, y, TR, TD, cart_container);\n\t\t\t\t\t});\n\n\t\t\t\t\treturn cart_container;\n\t\t\t\t},\n\n\t\t\t\t// generate a cart row from an item\n\t\t\t\tcreateCartRow: function (item, y, TR, TD, container) {\n\t\t\t\t\tvar row = simpleCart.$create(TR)\n\t\t\t\t\t\t\t\t\t\t.addClass('itemRow row-' + y + \" \" + (y % 2 ? \"even\" : \"odd\"))\n\t\t\t\t\t\t\t\t\t\t.attr('id', \"cartItem_\" + item.id()),\n\t\t\t\t\t\tj,\n\t\t\t\t\t\tjlen,\n\t\t\t\t\t\tcolumn,\n\t\t\t\t\t\tklass,\n\t\t\t\t\t\tcontent,\n\t\t\t\t\t\tcell;\n\n\t\t\t\t\tcontainer.append(row);\n\n\t\t\t\t\t// cycle through the columns to create each cell for the item\n\t\t\t\t\tfor (j = 0, jlen = settings.cartColumns.length; j < jlen; j += 1) {\n\t\t\t\t\t\tcolumn\t= cartColumn(settings.cartColumns[j]);\n\t\t\t\t\t\tklass\t= \"item-\" + (column.attr || (isString(column.view) ? column.view : column.label || column.text || \"cell\")) + \" \" + column.className;\n\t\t\t\t\t\tcontent = cartCellView(item, column);\n\t\t\t\t\t\tcell\t= simpleCart.$create(TD).addClass(klass).html(content);\n\n\t\t\t\t\t\trow.append(cell);\n\t\t\t\t\t}\n\t\t\t\t\treturn row;\n\t\t\t\t}\n\n\t\t\t});\n\n\t\t\t/*******************************************************************\n\t\t\t *\tCART ITEM CLASS MANAGEMENT\n\t\t\t *******************************************************************/\n\n\t\t\tsimpleCart.Item = function (info) {\n\n\t\t\t\t// we use the data object to track values for the item\n\t\t\t\tvar _data = {},\n\t\t\t\t\tme = this;\n\n\t\t\t\t// cycle through given attributes and set them to the data object\n\t\t\t\tif (isObject(info)) {\n\t\t\t\t\tsimpleCart.extend(_data, info);\n\t\t\t\t}\n\n\t\t\t\t// set the item id\n\t\t\t\titem_id += 1;\n\t\t\t\t_data.id = _data.id || item_id_namespace + item_id;\n\t\t\t\twhile (!isUndefined(sc_items[_data.id])) {\n\t\t\t\t\titem_id += 1;\n\t\t\t\t\t_data.id = item_id_namespace + item_id;\n\t\t\t\t}\n\n\t\t\t\tfunction checkQuantityAndPrice() {\n\n\t\t\t\t\t// check to make sure price is valid\n\t\t\t\t\tif (isString(_data.price)) {\n\t\t\t\t\t   // trying to remove all chars that aren't numbers or '.'\n\t\t\t\t\t\t_data.price = parseFloat(_data.price.replace(simpleCart.currency().decimal, \".\").replace(/[^0-9\\.]+/ig, \"\"));\n\n\t\t\t\t\t}\n\t\t\t\t\tif (isNaN(_data.price)) {\n\t\t\t\t\t\t_data.price = 0;\n\t\t\t\t\t}\n\t\t\t\t\tif (_data.price < 0) {\n\t\t\t\t\t\t_data.price = 0;\n\t\t\t\t\t}\n\n\t\t\t\t\t// check to make sure quantity is valid\n\t\t\t\t\tif (isString(_data.quantity)) {\n\t\t\t\t\t\t_data.quantity = parseInt(_data.quantity.replace(simpleCart.currency().delimiter, \"\"), 10);\n\t\t\t\t\t}\n\t\t\t\t\tif (isNaN(_data.quantity)) {\n\t\t\t\t\t\t_data.quantity = 1;\n\t\t\t\t\t}\n\t\t\t\t\tif (_data.quantity <= 0) {\n\t\t\t\t\t\tme.remove();\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\t// getter and setter methods to access private variables\n\t\t\t\tme.get = function (name, skipPrototypes) {\n\n\t\t\t\t\tvar usePrototypes = !skipPrototypes;\n\n\t\t\t\t\tif (isUndefined(name)) {\n\t\t\t\t\t\treturn name;\n\t\t\t\t\t}\n\n\t\t\t\t\t// return the value in order of the data object and then the prototype\n\t\t\t\t\treturn isFunction(_data[name])\t? _data[name].call(me) :\n\t\t\t\t\t\t\t!isUndefined(_data[name]) ? _data[name] :\n\n\t\t\t\t\t\t\tisFunction(me[name]) && usePrototypes\t\t? me[name].call(me) :\n\t\t\t\t\t\t\t!isUndefined(me[name]) && usePrototypes\t? me[name] :\n\t\t\t\t\t\t\t_data[name];\n\t\t\t\t};\n\t\t\t\tme.set = function (name, value) {\n\t\t\t\t\tif (!isUndefined(name)) {\n\t\t\t\t\t\t_data[name.toLowerCase()] = value;\n\t\t\t\t\t\tif (name.toLowerCase() === 'price' || name.toLowerCase() === 'quantity') {\n\t\t\t\t\t\t\tcheckQuantityAndPrice();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn me;\n\t\t\t\t};\n\t\t\t\tme.equals = function (item) {\n\t\t\t\t\tfor( var label in _data ){\n\t\t\t\t\t\tif (Object.prototype.hasOwnProperty.call(_data, label)) {\n\t\t\t\t\t\t\tif (label !== 'quantity' && label !== 'id') {\n\t\t\t\t\t\t\t\tif (item.get(label) !== _data[label]) {\n\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn true;\n\t\t\t\t};\n\t\t\t\tme.options = function () {\n\t\t\t\t\tvar data = {};\n\t\t\t\t\tsimpleCart.each(_data,function (val, x, label) {\n\t\t\t\t\t\tvar add = true;\n\t\t\t\t\t\tsimpleCart.each(me.reservedFields(), function (field) {\n\t\t\t\t\t\t\tif (field === label) {\n\t\t\t\t\t\t\t\tadd = false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn add;\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tif (add) {\n\t\t\t\t\t\t\tdata[label] = me.get(label);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\treturn data;\n\t\t\t\t};\n\n\n\t\t\t\tcheckQuantityAndPrice();\n\t\t\t};\n\n\t\t\tsimpleCart.Item._ = simpleCart.Item.prototype = {\n\n\t\t\t\t// editing the item quantity\n\t\t\t\tincrement: function (amount) {\n\t\t\t\t\tvar diff = amount || 1;\n\t\t\t\t\tdiff = parseInt(diff, 10);\n\n\t\t\t\t\tthis.quantity(this.quantity() + diff);\n\t\t\t\t\tif (this.quantity() < 1) {\n\t\t\t\t\t\tthis.remove();\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t}\n\t\t\t\t\treturn this;\n\n\t\t\t\t},\n\t\t\t\tdecrement: function (amount) {\n\t\t\t\t\tvar diff = amount || 1;\n\t\t\t\t\treturn this.increment(-parseInt(diff, 10));\n\t\t\t\t},\n\t\t\t\tremove: function (skipUpdate) {\n\t\t\t\t\tvar removeItemBool = simpleCart.trigger(\"beforeRemove\", [sc_items[this.id()]]);\n\t\t\t\t\tif (removeItemBool === false ) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\tdelete sc_items[this.id()];\n\t\t\t\t\tif (!skipUpdate) { \n\t\t\t\t\t\tsimpleCart.update();\n\t\t\t\t\t}\n\t\t\t\t\treturn null;\n\t\t\t\t},\n\n\t\t\t\t// special fields for items\n\t\t\t\treservedFields: function () {\n\t\t\t\t\treturn ['quantity', 'id', 'item_number', 'price', 'name', 'shipping', 'tax', 'taxRate'];\n\t\t\t\t},\n\n\t\t\t\t// return values for all reserved fields if they exist\n\t\t\t\tfields: function () {\n\t\t\t\t\tvar data = {},\n\t\t\t\t\t\tme = this;\n\t\t\t\t\tsimpleCart.each(me.reservedFields(), function (field) {\n\t\t\t\t\t\tif (me.get(field)) {\n\t\t\t\t\t\t\tdata[field] = me.get(field);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\treturn data;\n\t\t\t\t},\n\n\n\t\t\t\t// shortcuts for getter/setters. can\n\t\t\t\t// be overwritten for customization\n\t\t\t\t// btw, we are hiring at wojo design, and could\n\t\t\t\t// use a great web designer. if thats you, you can\n\t\t\t\t// get more info at http://wojodesign.com/now-hiring/\n\t\t\t\t// or email me directly: brett@wojodesign.com\n\t\t\t\tquantity: function (val) {\n\t\t\t\t\treturn isUndefined(val) ? parseInt(this.get(\"quantity\", true) || 1, 10) : this.set(\"quantity\", val);\n\t\t\t\t},\n\t\t\t\tprice: function (val) {\n\t\t\t\t\treturn isUndefined(val) ?\n\t\t\t\t\t\t\tparseFloat((this.get(\"price\",true).toString()).replace(simpleCart.currency().symbol,\"\").replace(simpleCart.currency().delimiter,\"\") || 1) :\n\t\t\t\t\t\t\tthis.set(\"price\", parseFloat((val).toString().replace(simpleCart.currency().symbol,\"\").replace(simpleCart.currency().delimiter,\"\")));\n\t\t\t\t},\n\t\t\t\tid: function () {\n\t\t\t\t\treturn this.get('id',false);\n\t\t\t\t},\n\t\t\t\ttotal:function () {\n\t\t\t\t\treturn this.quantity()*this.price();\n\t\t\t\t}\n\n\t\t\t};\n\n\n\n\n\t\t\t/*******************************************************************\n\t\t\t *\tCHECKOUT MANAGEMENT\n\t\t\t *******************************************************************/\n\n\t\t\tsimpleCart.extend({\n\t\t\t\tcheckout: function () {\n\t\t\t\t\tif (settings.checkout.type.toLowerCase() === 'custom' && isFunction(settings.checkout.fn)) {\n\t\t\t\t\t\tsettings.checkout.fn.call(simpleCart,settings.checkout);\n\t\t\t\t\t} else if (isFunction(simpleCart.checkout[settings.checkout.type])) {\n\t\t\t\t\t\tvar checkoutData = simpleCart.checkout[settings.checkout.type].call(simpleCart,settings.checkout);\n\t\t\t\t\t\t\n\t\t\t\t\t\t// if the checkout method returns data, try to send the form\n\t\t\t\t\t\tif( checkoutData.data && checkoutData.action && checkoutData.method ){\n\t\t\t\t\t\t\t// if no one has any objections, send the checkout form\n\t\t\t\t\t\t\tif( false !== simpleCart.trigger('beforeCheckout', [checkoutData.data]) ){\n\t\t\t\t\t\t\t\tsimpleCart.generateAndSendForm( checkoutData );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t} else {\n\t\t\t\t\t\tsimpleCart.error(\"No Valid Checkout Method Specified\");\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\textendCheckout: function (methods) {\n\t\t\t\t\treturn simpleCart.extend(simpleCart.checkout, methods);\n\t\t\t\t},\n\t\t\t\tgenerateAndSendForm: function (opts) {\n\t\t\t\t\tvar form = simpleCart.$create(\"form\");\n\t\t\t\t\tform.attr('style', 'display:none;');\n\t\t\t\t\tform.attr('action', opts.action);\n\t\t\t\t\tform.attr('method', opts.method);\n\t\t\t\t\tsimpleCart.each(opts.data, function (val, x, name) {\n\t\t\t\t\t\tform.append(\n\t\t\t\t\t\t\tsimpleCart.$create(\"input\").attr(\"type\",\"hidden\").attr(\"name\",name).val(val)\n\t\t\t\t\t\t);\n\t\t\t\t\t});\n\t\t\t\t\tsimpleCart.$(\"body\").append(form);\n\t\t\t\t\tform.el.submit();\n\t\t\t\t\tform.remove();\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tsimpleCart.extendCheckout({\n\t\t\t\tPayPal: function (opts) {\n\t\t\t\t\t// account email is required\n\t\t\t\t\tif (!opts.email) {\n\t\t\t\t\t\treturn simpleCart.error(\"No email provided for PayPal checkout\");\n\t\t\t\t\t}\n\n\t\t\t\t\t// build basic form options\n\t\t\t\t\tvar data = {\n\t\t\t\t\t\t\t  cmd\t\t\t: \"_cart\"\n\t\t\t\t\t\t\t, upload\t\t: \"1\"\n\t\t\t\t\t\t\t, currency_code : simpleCart.currency().code\n\t\t\t\t\t\t\t, business\t\t: opts.email\n\t\t\t\t\t\t\t, rm\t\t\t: opts.method === \"GET\" ? \"0\" : \"2\"\n\t\t\t\t\t\t\t, tax_cart\t\t: (simpleCart.tax()*1).toFixed(2)\n\t\t\t\t\t\t\t, handling_cart : (simpleCart.shipping()*1).toFixed(2)\n\t\t\t\t\t\t\t, charset\t\t: \"utf-8\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\taction = opts.sandbox ? \"https://www.sandbox.paypal.com/cgi-bin/webscr\" : \"https://www.paypal.com/cgi-bin/webscr\",\n\t\t\t\t\t\tmethod = opts.method === \"GET\" ? \"GET\" : \"POST\";\n\n\n\t\t\t\t\t// check for return and success URLs in the options\n\t\t\t\t\tif (opts.success) {\n\t\t\t\t\t\tdata['return'] = opts.success;\n\t\t\t\t\t}\n\t\t\t\t\tif (opts.cancel) {\n\t\t\t\t\t\tdata.cancel_return = opts.cancel;\n\t\t\t\t\t}\n\t\t\t\t\tif (opts.notify) {\n\t\t\t\t\t\tdata.notify_url = opts.notify;\n\t\t\t\t\t}\n\n\n\t\t\t\t\t// add all the items to the form data\n\t\t\t\t\tsimpleCart.each(function (item,x) {\n\t\t\t\t\t\tvar counter = x+1,\n\t\t\t\t\t\t\titem_options = item.options(),\n\t\t\t\t\t\t\toptionCount = 0,\n\t\t\t\t\t\t\tsend;\n\t\n\t\t\t\t\t\t// basic item data\n\t\t\t\t\t\tdata[\"item_name_\" + counter] = item.get(\"name\");\n\t\t\t\t\t\tdata[\"quantity_\" + counter] = item.quantity();\n\t\t\t\t\t\tdata[\"amount_\" + counter] = (item.price()*1).toFixed(2);\n\t\t\t\t\t\tdata[\"item_number_\" + counter] = item.get(\"item_number\") || counter;\n\n\n\t\t\t\t\t\t// add the options\n\t\t\t\t\t\tsimpleCart.each(item_options, function (val,k,attr) {\n\t\t\t\t\t\t\t// paypal limits us to 10 options\n\t\t\t\t\t\t\tif (k < 10) {\n\t\t\n\t\t\t\t\t\t\t\t// check to see if we need to exclude this from checkout\n\t\t\t\t\t\t\t\tsend = true;\n\t\t\t\t\t\t\t\tsimpleCart.each(settings.excludeFromCheckout, function (field_name) {\n\t\t\t\t\t\t\t\t\tif (field_name === attr) { send = false; }\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tif (send) {\n\t\t\t\t\t\t\t\t\t\toptionCount += 1;\n\t\t\t\t\t\t\t\t\t\tdata[\"on\" + k + \"_\" + counter] = attr;\n\t\t\t\t\t\t\t\t\t\tdata[\"os\" + k + \"_\" + counter] = val;\n\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\t// options count\n\t\t\t\t\t\tdata[\"option_index_\"+ x] = Math.min(10, optionCount);\n\t\t\t\t\t});\n\n\n\t\t\t\t\t// return the data for the checkout form\n\t\t\t\t\treturn {\n\t\t\t\t\t\t  action\t: action\n\t\t\t\t\t\t, method\t: method\n\t\t\t\t\t\t, data\t\t: data\n\t\t\t\t\t};\n\n\t\t\t\t},\n\n\n\t\t\t\tGoogleCheckout: function (opts) {\n\t\t\t\t\t// account id is required\n\t\t\t\t\tif (!opts.merchantID) {\n\t\t\t\t\t\treturn simpleCart.error(\"No merchant id provided for GoogleCheckout\");\n\t\t\t\t\t}\n\n\t\t\t\t\t// google only accepts USD and GBP\n\t\t\t\t\tif (simpleCart.currency().code !== \"USD\" && simpleCart.currency().code !== \"GBP\") {\n\t\t\t\t\t\treturn simpleCart.error(\"Google Checkout only accepts USD and GBP\");\n\t\t\t\t\t}\n\n\t\t\t\t\t// build basic form options\n\t\t\t\t\tvar data = {\n\t\t\t\t\t\t\t// TODO: better shipping support for this google\n\t\t\t\t\t\t\t  ship_method_name_1\t: \"Shipping\"\n\t\t\t\t\t\t\t, ship_method_price_1\t: simpleCart.shipping()\n\t\t\t\t\t\t\t, ship_method_currency_1: simpleCart.currency().code\n\t\t\t\t\t\t\t, _charset_\t\t\t\t: ''\n\t\t\t\t\t\t},\n\t\t\t\t\t\taction = \"https://checkout.google.com/api/checkout/v2/checkoutForm/Merchant/\" + opts.merchantID,\n\t\t\t\t\t\tmethod = opts.method === \"GET\" ? \"GET\" : \"POST\";\n\n\n\t\t\t\t\t// add items to data\n\t\t\t\t\tsimpleCart.each(function (item,x) {\n\t\t\t\t\t\tvar counter = x+1,\n\t\t\t\t\t\t\toptions_list = [],\n\t\t\t\t\t\t\tsend;\n\t\t\t\t\t\tdata['item_name_' + counter]\t\t= item.get('name');\n\t\t\t\t\t\tdata['item_quantity_' + counter]\t= item.quantity();\n\t\t\t\t\t\tdata['item_price_' + counter]\t\t= item.price();\n\t\t\t\t\t\tdata['item_currency_ ' + counter]\t= simpleCart.currency().code;\n\t\t\t\t\t\tdata['item_tax_rate' + counter]\t\t= item.get('taxRate') || simpleCart.taxRate();\n\n\t\t\t\t\t\t// create array of extra options\n\t\t\t\t\t\tsimpleCart.each(item.options(), function (val,x,attr) {\n\t\t\t\t\t\t\t// check to see if we need to exclude this from checkout\n\t\t\t\t\t\t\tsend = true;\n\t\t\t\t\t\t\tsimpleCart.each(settings.excludeFromCheckout, function (field_name) {\n\t\t\t\t\t\t\t\tif (field_name === attr) { send = false; }\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tif (send) {\n\t\t\t\t\t\t\t\toptions_list.push(attr + \": \" + val);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\t// add the options to the description\n\t\t\t\t\t\tdata['item_description_' + counter] = options_list.join(\", \");\n\t\t\t\t\t});\n\n\t\t\t\t\t// return the data for the checkout form\n\t\t\t\t\treturn {\n\t\t\t\t\t\t  action\t: action\n\t\t\t\t\t\t, method\t: method\n\t\t\t\t\t\t, data\t\t: data\n\t\t\t\t\t};\n\n\n\t\t\t\t},\n\n\n\t\t\t\tAmazonPayments: function (opts) {\n\t\t\t\t\t// required options\n\t\t\t\t\tif (!opts.merchant_signature) {\n\t\t\t\t\t\treturn simpleCart.error(\"No merchant signature provided for Amazon Payments\");\n\t\t\t\t\t}\n\t\t\t\t\tif (!opts.merchant_id) {\n\t\t\t\t\t\treturn simpleCart.error(\"No merchant id provided for Amazon Payments\");\n\t\t\t\t\t}\n\t\t\t\t\tif (!opts.aws_access_key_id) {\n\t\t\t\t\t\treturn simpleCart.error(\"No AWS access key id provided for Amazon Payments\");\n\t\t\t\t\t}\n\n\n\t\t\t\t\t// build basic form options\n\t\t\t\t\tvar data = {\n\t\t\t\t\t\t\t  aws_access_key_id:\topts.aws_access_key_id\n\t\t\t\t\t\t\t, merchant_signature:\topts.merchant_signature\n\t\t\t\t\t\t\t, currency_code:\t\tsimpleCart.currency().code\n\t\t\t\t\t\t\t, tax_rate:\t\t\t\tsimpleCart.taxRate()\n\t\t\t\t\t\t\t, weight_unit:\t\t\topts.weight_unit || 'lb'\n\t\t\t\t\t\t},\n\t\t\t\t\t\taction = \"https://payments\" + (opts.sandbox ? \"-sandbox\" : \"\") + \".amazon.com/checkout/\" + opts.merchant_id,\n\t\t\t\t\t\tmethod = opts.method === \"GET\" ? \"GET\" : \"POST\";\n\n\n\t\t\t\t\t// add items to data\n\t\t\t\t\tsimpleCart.each(function (item,x) {\n\t\t\t\t\t\tvar counter = x+1,\n\t\t\t\t\t\t\toptions_list = [];\n\t\t\t\t\t\tdata['item_title_' + counter]\t\t\t= item.get('name');\n\t\t\t\t\t\tdata['item_quantity_' + counter]\t\t= item.quantity();\n\t\t\t\t\t\tdata['item_price_' + counter]\t\t\t= item.price();\n\t\t\t\t\t\tdata['item_sku_ ' + counter]\t\t\t= item.get('sku') || item.id();\n\t\t\t\t\t\tdata['item_merchant_id_' + counter]\t= opts.merchant_id;\n\t\t\t\t\t\tif (item.get('weight')) {\n\t\t\t\t\t\t\tdata['item_weight_' + counter]\t\t= item.get('weight');\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (settings.shippingQuantityRate) {\n\t\t\t\t\t\t\tdata['shipping_method_price_per_unit_rate_' + counter] = settings.shippingQuantityRate;\n\t\t\t\t\t\t}\n\n\n\t\t\t\t\t\t// create array of extra options\n\t\t\t\t\t\tsimpleCart.each(item.options(), function (val,x,attr) {\n\t\t\t\t\t\t\t// check to see if we need to exclude this from checkout\n\t\t\t\t\t\t\tvar send = true;\n\t\t\t\t\t\t\tsimpleCart.each(settings.excludeFromCheckout, function (field_name) {\n\t\t\t\t\t\t\t\tif (field_name === attr) { send = false; }\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tif (send && attr !== 'weight' && attr !== 'tax') {\n\t\t\t\t\t\t\t\toptions_list.push(attr + \": \" + val);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\t// add the options to the description\n\t\t\t\t\t\tdata['item_description_' + counter] = options_list.join(\", \");\n\t\t\t\t\t});\n\n\t\t\t\t\t// return the data for the checkout form\n\t\t\t\t\treturn {\n\t\t\t\t\t\t  action\t: action\n\t\t\t\t\t\t, method\t: method\n\t\t\t\t\t\t, data\t\t: data\n\t\t\t\t\t};\n\n\t\t\t\t},\n\n\n\t\t\t\tSendForm: function (opts) {\n\t\t\t\t\t// url required\n\t\t\t\t\tif (!opts.url) {\n\t\t\t\t\t\treturn simpleCart.error('URL required for SendForm Checkout');\n\t\t\t\t\t}\n\n\t\t\t\t\t// build basic form options\n\t\t\t\t\tvar data = {\n\t\t\t\t\t\t\t  currency\t: simpleCart.currency().code\n\t\t\t\t\t\t\t, shipping\t: simpleCart.shipping()\n\t\t\t\t\t\t\t, tax\t\t: simpleCart.tax()\n\t\t\t\t\t\t\t, taxRate\t: simpleCart.taxRate()\n\t\t\t\t\t\t\t, itemCount : simpleCart.find({}).length\n\t\t\t\t\t\t},\n\t\t\t\t\t\taction = opts.url,\n\t\t\t\t\t\tmethod = opts.method === \"GET\" ? \"GET\" : \"POST\";\n\n\n\t\t\t\t\t// add items to data\n\t\t\t\t\tsimpleCart.each(function (item,x) {\n\t\t\t\t\t\tvar counter = x+1,\n\t\t\t\t\t\t\toptions_list = [],\n\t\t\t\t\t\t\tsend;\n\t\t\t\t\t\tdata['item_name_' + counter]\t\t= item.get('name');\n\t\t\t\t\t\tdata['item_quantity_' + counter]\t= item.quantity();\n\t\t\t\t\t\tdata['item_price_' + counter]\t\t= item.price();\n\n\t\t\t\t\t\t// create array of extra options\n\t\t\t\t\t\tsimpleCart.each(item.options(), function (val,x,attr) {\n\t\t\t\t\t\t\t// check to see if we need to exclude this from checkout\n\t\t\t\t\t\t\tsend = true;\n\t\t\t\t\t\t\tsimpleCart.each(settings.excludeFromCheckout, function (field_name) {\n\t\t\t\t\t\t\t\tif (field_name === attr) { send = false; }\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tif (send) {\n\t\t\t\t\t\t\t\toptions_list.push(attr + \": \" + val);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\t// add the options to the description\n\t\t\t\t\t\tdata['item_options_' + counter] = options_list.join(\", \");\n\t\t\t\t\t});\n\n\n\t\t\t\t\t// check for return and success URLs in the options\n\t\t\t\t\tif (opts.success) {\n\t\t\t\t\t\tdata['return'] = opts.success;\n\t\t\t\t\t}\n\t\t\t\t\tif (opts.cancel) {\n\t\t\t\t\t\tdata.cancel_return = opts.cancel;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (opts.extra_data) {\n\t\t\t\t\t\tdata = simpleCart.extend(data,opts.extra_data);\n\t\t\t\t\t}\n\n\t\t\t\t\t// return the data for the checkout form\n\t\t\t\t\treturn {\n\t\t\t\t\t\t  action\t: action\n\t\t\t\t\t\t, method\t: method\n\t\t\t\t\t\t, data\t\t: data\n\t\t\t\t\t};\n\t\t\t\t}\n\n\n\t\t\t});\n\n\n\t\t\t/*******************************************************************\n\t\t\t *\tEVENT MANAGEMENT\n\t\t\t *******************************************************************/\n\t\t\teventFunctions = {\n\n\t\t\t\t// bind a callback to an event\n\t\t\t\tbind: function (name, callback) {\n\t\t\t\t\tif (!isFunction(callback)) {\n\t\t\t\t\t\treturn this;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!this._events) {\n\t\t\t\t\t\tthis._events = {};\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t// split by spaces to allow for multiple event bindings at once\n\t\t\t\t\tvar eventNameList = name.split(/ +/);\n\t\t\t\t\t\n\t\t\t\t\t// iterate through and bind each event\n\t\t\t\t\tsimpleCart.each( eventNameList , function( eventName ){\n\t\t\t\t\t\tif (this._events[eventName] === true) {\n\t\t\t\t\t\t\tcallback.apply(this);\n\t\t\t\t\t\t} else if (!isUndefined(this._events[eventName])) {\n\t\t\t\t\t\t\tthis._events[eventName].push(callback);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis._events[eventName] = [callback];\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\t\n\t\t\t\t\treturn this;\n\t\t\t\t},\n\t\t\t\t\n\t\t\t\t// trigger event\n\t\t\t\ttrigger: function (name, options) {\n\t\t\t\t\tvar returnval = true,\n\t\t\t\t\t\tx,\n\t\t\t\t\t\txlen;\n\n\t\t\t\t\tif (!this._events) {\n\t\t\t\t\t\tthis._events = {};\n\t\t\t\t\t}\n\t\t\t\t\tif (!isUndefined(this._events[name]) && isFunction(this._events[name][0])) {\n\t\t\t\t\t\tfor (x = 0, xlen = this._events[name].length; x < xlen; x += 1) {\n\t\t\t\t\t\t\treturnval = this._events[name][x].apply(this, (options || []));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (returnval === false) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t};\n\t\t\t// alias for bind\n\t\t\teventFunctions.on = eventFunctions.bind;\n\t\t\tsimpleCart.extend(eventFunctions);\n\t\t\tsimpleCart.extend(simpleCart.Item._, eventFunctions);\n\n\n\t\t\t// base simpleCart events in options\n\t\t\tbaseEvents = {\n\t\t\t\t  beforeAdd\t\t\t\t: null\n\t\t\t\t, afterAdd\t\t\t\t: null\n\t\t\t\t, load\t\t\t\t\t: null\n\t\t\t\t, beforeSave\t\t\t: null\n\t\t\t\t, afterSave\t\t\t\t: null\n\t\t\t\t, update\t\t\t\t: null\n\t\t\t\t, ready\t\t\t\t\t: null\n\t\t\t\t, checkoutSuccess\t\t: null\n\t\t\t\t, checkoutFail\t\t\t: null\n\t\t\t\t, beforeCheckout\t\t: null\n\t\t\t\t, beforeRemove\t\t\t: null\n\t\t\t};\n\t\t\t\n\t\t\t// extend with base events\n\t\t\tsimpleCart(baseEvents);\n\n\t\t\t// bind settings to events\n\t\t\tsimpleCart.each(baseEvents, function (val, x, name) {\n\t\t\t\tsimpleCart.bind(name, function () {\n\t\t\t\t\tif (isFunction(settings[name])) {\n\t\t\t\t\t\tsettings[name].apply(this, arguments);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\n\t\t\t/*******************************************************************\n\t\t\t *\tFORMATTING FUNCTIONS\n\t\t\t *******************************************************************/\n\t\t\tsimpleCart.extend({\n\t\t\t\ttoCurrency: function (number,opts) {\n\t\t\t\t\tvar num = parseFloat(number),\n\t\t\t\t\t\topt_input = opts || {},\n\t\t\t\t\t\t_opts = simpleCart.extend(simpleCart.extend({\n\t\t\t\t\t\t\t  symbol:\t\t\"$\"\n\t\t\t\t\t\t\t, decimal:\t\t\".\"\n\t\t\t\t\t\t\t, delimiter:\t\",\"\n\t\t\t\t\t\t\t, accuracy:\t\t2\n\t\t\t\t\t\t\t, after: false\n\t\t\t\t\t\t}, simpleCart.currency()), opt_input),\n\n\t\t\t\t\t\tnumParts = num.toFixed(_opts.accuracy).split(\".\"),\n\t\t\t\t\t\tdec = numParts[1],\n\t\t\t\t\t\tints = numParts[0];\n\t\t\t\n\t\t\t\t\tints = simpleCart.chunk(ints.reverse(), 3).join(_opts.delimiter.reverse()).reverse();\n\n\t\t\t\t\treturn\t(!_opts.after ? _opts.symbol : \"\") +\n\t\t\t\t\t\t\tints +\n\t\t\t\t\t\t\t(dec ? _opts.decimal + dec : \"\") +\n\t\t\t\t\t\t\t(_opts.after ? _opts.symbol : \"\");\n\t\n\t\t\t\t},\n\n\n\t\t\t\t// break a string in blocks of size n\n\t\t\t\tchunk: function (str, n) {\n\t\t\t\t\tif (typeof n==='undefined') {\n\t\t\t\t\t\tn=2;\n\t\t\t\t\t}\n\t\t\t\t\tvar result = str.match(new RegExp('.{1,' + n + '}','g'));\n\t\t\t\t\treturn result || [];\n\t\t\t\t}\n\n\t\t\t});\n\n\n\t\t\t// reverse string function\n\t\t\tString.prototype.reverse = function () {\n\t\t\t\treturn this.split(\"\").reverse().join(\"\");\n\t\t\t};\n\n\n\t\t\t// currency functions\n\t\t\tsimpleCart.extend({\n\t\t\t\tcurrency: function (currency) {\n\t\t\t\t\tif (isString(currency) && !isUndefined(currencies[currency])) {\n\t\t\t\t\t\tsettings.currency = currency;\n\t\t\t\t\t} else if (isObject(currency)) {\n\t\t\t\t\t\tcurrencies[currency.code] = currency;\n\t\t\t\t\t\tsettings.currency = currency.code;\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn currencies[settings.currency];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\n\t\t\t/*******************************************************************\n\t\t\t *\tVIEW MANAGEMENT\n\t\t\t *******************************************************************/\n\n\t\t\tsimpleCart.extend({\n\t\t\t\t// bind outlets to function\n\t\t\t\tbindOutlets: function (outlets) {\n\t\t\t\t\tsimpleCart.each(outlets, function (callback, x, selector) {\n\t\t\t\t\t\t\n\t\t\t\t\t\tsimpleCart.bind('update', function () {\n\t\t\t\t\t\t\tsimpleCart.setOutlet(\".\" + namespace + \"_\" + selector, callback);\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t},\n\n\t\t\t\t// set function return to outlet\n\t\t\t\tsetOutlet: function (selector, func) {\n\t\t\t\t\tvar val = func.call(simpleCart, selector);\n\t\t\t\t\tif (isObject(val) && val.el) {\n\t\t\t\t\t\tsimpleCart.$(selector).html(' ').append(val);\n\t\t\t\t\t} else if (!isUndefined(val)) {\n\t\t\t\t\t\tsimpleCart.$(selector).html(val);\n\t\t\t\t\t}\n\t\t\t\t},\n\n\t\t\t\t// bind click events on inputs\n\t\t\t\tbindInputs: function (inputs) {\n\t\t\t\t\tsimpleCart.each(inputs, function (info) {\n\t\t\t\t\t\tsimpleCart.setInput(\".\" + namespace + \"_\" + info.selector, info.event, info.callback);\n\t\t\t\t\t});\n\t\t\t\t},\n\n\t\t\t\t// attach events to inputs\t\n\t\t\t\tsetInput: function (selector, event, func) {\n\t\t\t\t\tsimpleCart.$(selector).live(event, func);\n\t\t\t\t}\n\t\t\t});\t\t\n\n\n\t\t\t// class for wrapping DOM selector shit\n\t\t\tsimpleCart.ELEMENT = function (selector) {\n\n\t\t\t\tthis.create(selector);\n\t\t\t\tthis.selector = selector || null; // \"#\" + this.attr('id'); TODO: test length?\n\t\t\t};\n\n\t\t\tsimpleCart.extend(selectorFunctions, {\n\n\t\t\t\t\"MooTools\"\t\t: {\n\t\t\t\t\ttext: function (text) {\n\t\t\t\t\t\treturn this.attr(_TEXT_, text);\n\t\t\t\t\t},\n\t\t\t\t\thtml: function (html) {\n\t\t\t\t\t\treturn this.attr(_HTML_, html);\n\t\t\t\t\t},\n\t\t\t\t\tval: function (val) {\n\t\t\t\t\t\treturn this.attr(_VALUE_, val);\n\t\t\t\t\t},\n\t\t\t\t\tattr: function (attr, val) {\n\t\t\t\t\t\tif (isUndefined(val)) {\n\t\t\t\t\t\t\treturn this.el[0] && this.el[0].get(attr);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tthis.el.set(attr, val);\n\t\t\t\t\t\treturn this;\n\t\t\t\t\t},\n\t\t\t\t\tremove: function () {\n\t\t\t\t\t\tthis.el.dispose();\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t},\n\t\t\t\t\taddClass: function (klass) {\n\t\t\t\t\t\tthis.el.addClass(klass);\n\t\t\t\t\t\treturn this;\n\t\t\t\t\t},\n\t\t\t\t\tremoveClass: function (klass) {\n\t\t\t\t\t\tthis.el.removeClass(klass);\n\t\t\t\t\t\treturn this;\n\t\t\t\t\t},\n\t\t\t\t\tappend: function (item) {\n\t\t\t\t\t\tthis.el.adopt(item.el);\n\t\t\t\t\t\treturn this;\n\t\t\t\t\t},\n\t\t\t\t\teach: function (callback) {\n\t\t\t\t\t\tif (isFunction(callback)) {\n\t\t\t\t\t\t\tsimpleCart.each(this.el, function( e, i, c) {\n\t\t\t\t\t\t\t\tcallback.call( i, i, e, c );\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn this;\n\t\t\t\t\t},\n\t\t\t\t\tclick: function (callback) {\n\t\t\t\t\t\tif (isFunction(callback)) {\n\t\t\t\t\t\t\tthis.each(function (e) {\n\t\t\t\t\t\t\t\te.addEvent(_CLICK_, function (ev) {\n\t\t\t\t\t\t\t\t\tcallback.call(e,ev);\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} else if (isUndefined(callback)) {\n\t\t\t\t\t\t\tthis.el.fireEvent(_CLICK_);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn this;\n\t\t\t\t\t},\n\t\t\t\t\tlive: function (\tevent,callback) {\n\t\t\t\t\t\tvar selector = this.selector;\n\t\t\t\t\t\tif (isFunction(callback)) {\n\t\t\t\t\t\t\tsimpleCart.$(\"body\").el.addEvent(event + \":relay(\" + selector + \")\", function (e, el) {\n\t\t\t\t\t\t\t\tcallback.call(el, e);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tmatch: function (selector) {\n\t\t\t\t\t\treturn this.el.match(selector);\n\t\t\t\t\t},\n\t\t\t\t\tparent: function () {\n\t\t\t\t\t\treturn simpleCart.$(this.el.getParent());\n\t\t\t\t\t},\n\t\t\t\t\tfind: function (selector) {\n\t\t\t\t\t\treturn simpleCart.$(this.el.getElements(selector));\n\t\t\t\t\t},\n\t\t\t\t\tclosest: function (selector) {\n\t\t\t\t\t\treturn simpleCart.$(this.el.getParent(selector));\n\t\t\t\t\t},\n\t\t\t\t\tdescendants: function () {\n\t\t\t\t\t\treturn this.find(\"*\");\n\t\t\t\t\t},\n\t\t\t\t\ttag: function () {\n\t\t\t\t\t\treturn this.el[0].tagName;\n\t\t\t\t\t},\n\t\t\t\t\tsubmit: function (){\n\t\t\t\t\t\tthis.el[0].submit();\n\t\t\t\t\t\treturn this;\n\t\t\t\t\t},\n\t\t\t\t\tcreate: function (selector) {\n\t\t\t\t\t\tthis.el = $engine(selector);\n\t\t\t\t\t}\n\n\n\t\t\t\t},\n\n\t\t\t\t\"Prototype\"\t\t: {\n\t\t\t\t\ttext: function (text) {\n\t\t\t\t\t\tif (isUndefined(text)) {\n\t\t\t\t\t\t\treturn this.el[0].innerHTML;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.each(function (i,e) {\n\t\t\t\t\t\t\t$(e).update(text);\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn this;\n\t\t\t\t\t},\n\t\t\t\t\thtml: function (html) {\n\t\t\t\t\t\treturn this.text(html);\n\t\t\t\t\t},\n\t\t\t\t\tval: function (val) {\n\t\t\t\t\t\treturn this.attr(_VALUE_, val);\n\t\t\t\t\t},\n\t\t\t\t\tattr: function (attr, val) {\n\t\t\t\t\t\tif (isUndefined(val)) {\n\t\t\t\t\t\t\treturn this.el[0].readAttribute(attr);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.each(function (i,e) {\n\t\t\t\t\t\t\t$(e).writeAttribute(attr, val);\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn this;\n\t\t\t\t\t},\n\t\t\t\t\tappend: function (item) {\n\t\t\t\t\t\tthis.each(function (i,e) {\n\t\t\t\t\t\t\tif (item.el) {\n\t\t\t\t\t\t\t\titem.each(function (i2,e2) {\n\t\t\t\t\t\t\t\t\t$(e).appendChild(e2);\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t} else if (isElement(item)) {\n\t\t\t\t\t\t\t\t$(e).appendChild(item);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn this;\n\t\t\t\t\t},\n\t\t\t\t\tremove: function () {\n\t\t\t\t\t\tthis.each(function (i, e) {\n\t\t\t\t\t\t\t$(e).remove();\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn this;\n\t\t\t\t\t},\n\t\t\t\t\taddClass: function (klass) {\n\t\t\t\t\t\tthis.each(function (i, e) {\n\t\t\t\t\t\t\t$(e).addClassName(klass);\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn this;\n\t\t\t\t\t},\n\t\t\t\t\tremoveClass: function (klass) {\n\t\t\t\t\t\tthis.each(function (i, e) {\n\t\t\t\t\t\t\t$(e).removeClassName(klass);\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn this;\n\t\t\t\t\t},\n\t\t\t\t\teach: function (callback) {\n\t\t\t\t\t\tif (isFunction(callback)) {\n\t\t\t\t\t\t\tsimpleCart.each(this.el, function( e, i, c) {\n\t\t\t\t\t\t\t\tcallback.call( i, i, e, c );\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn this;\n\t\t\t\t\t},\n\t\t\t\t\tclick: function (callback) {\n\t\t\t\t\t\tif (isFunction(callback)) {\n\t\t\t\t\t\t\tthis.each(function (i, e) {\n\t\t\t\t\t\t\t\t$(e).observe(_CLICK_, function (ev) {\n\t\t\t\t\t\t\t\t\tcallback.call(e,ev);\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} else if (isUndefined(callback)) {\n\t\t\t\t\t\t\tthis.each(function (i, e) {\n\t\t\t\t\t\t\t\t$(e).fire(_CLICK_);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn this;\n\t\t\t\t\t},\n\t\t\t\t\tlive: function (event,callback) {\n\t\t\t\t\t\tif (isFunction(callback)) {\n\t\t\t\t\t\t\tvar selector = this.selector;\n\t\t\t\t\t\t\tdocument.observe(event, function (e, el) {\n\t\t\t\t\t\t\t\tif (el === $engine(e).findElement(selector)) {\n\t\t\t\t\t\t\t\t\tcallback.call(el, e);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tparent: function () {\n\t\t\t\t\t\treturn simpleCart.$(this.el.up());\n\t\t\t\t\t},\n\t\t\t\t\tfind: function (selector) {\n\t\t\t\t\t\treturn simpleCart.$(this.el.getElementsBySelector(selector));\n\t\t\t\t\t},\n\t\t\t\t\tclosest: function (selector) {\n\t\t\t\t\t\treturn simpleCart.$(this.el.up(selector));\n\t\t\t\t\t},\n\t\t\t\t\tdescendants: function () {\n\t\t\t\t\t\treturn simpleCart.$(this.el.descendants());\n\t\t\t\t\t},\n\t\t\t\t\ttag: function () {\n\t\t\t\t\t\treturn this.el.tagName;\n\t\t\t\t\t},\n\t\t\t\t\tsubmit: function() {\n\t\t\t\t\t\tthis.el[0].submit();\n\t\t\t\t\t},\n\n\t\t\t\t\tcreate: function (selector) {\n\t\t\t\t\t\tif (isString(selector)) {\n\t\t\t\t\t\t\tthis.el = $engine(selector);\n\t\t\t\t\t\t} else if (isElement(selector)) {\n\t\t\t\t\t\t\tthis.el = [selector];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\n\n\t\t\t\t},\n\n\t\t\t\t\"jQuery\": {\n\t\t\t\t\tpassthrough: function (action, val) {\n\t\t\t\t\t\tif (isUndefined(val)) {\n\t\t\t\t\t\t\treturn this.el[action]();\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tthis.el[action](val);\n\t\t\t\t\t\treturn this;\n\t\t\t\t\t},\n\t\t\t\t\ttext: function (text) {\n\t\t\t\t\t\treturn this.passthrough(_TEXT_, text);\n\t\t\t\t\t},\n\t\t\t\t\thtml: function (html) {\n\t\t\t\t\t\treturn this.passthrough(_HTML_, html);\n\t\t\t\t\t},\n\t\t\t\t\tval: function (val) {\n\t\t\t\t\t\treturn this.passthrough(\"val\", val);\n\t\t\t\t\t},\n\t\t\t\t\tappend: function (item) {\n\t\t\t\t\t\tvar target = item.el || item;\n\t\t\t\t\t\tthis.el.append(target);\n\t\t\t\t\t\treturn this;\n\t\t\t\t\t},\n\t\t\t\t\tattr: function (attr, val) {\n\t\t\t\t\t\tif (isUndefined(val)) {\n\t\t\t\t\t\t\treturn this.el.attr(attr);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.el.attr(attr, val);\n\t\t\t\t\t\treturn this;\n\t\t\t\t\t},\n\t\t\t\t\tremove: function () {\n\t\t\t\t\t\tthis.el.remove();\n\t\t\t\t\t\treturn this;\n\t\t\t\t\t},\n\t\t\t\t\taddClass: function (klass) {\n\t\t\t\t\t\tthis.el.addClass(klass);\n\t\t\t\t\t\treturn this;\n\t\t\t\t\t},\n\t\t\t\t\tremoveClass: function (klass) {\n\t\t\t\t\t\tthis.el.removeClass(klass);\n\t\t\t\t\t\treturn this;\n\t\t\t\t\t},\n\t\t\t\t\teach: function (callback) {\n\t\t\t\t\t\treturn this.passthrough('each', callback);\n\t\t\t\t\t},\n\t\t\t\t\tclick: function (callback) {\n\t\t\t\t\t\treturn this.passthrough(_CLICK_, callback);\n\t\t\t\t\t},\n\t\t\t\t\tlive: function (event, callback) {\n\t\t\t\t\t\t$engine(document).delegate(this.selector, event, callback);\n\t\t\t\t\t\treturn this;\n\t\t\t\t\t},\n\t\t\t\t\tparent: function () {\n\t\t\t\t\t\treturn simpleCart.$(this.el.parent());\n\t\t\t\t\t},\n\t\t\t\t\tfind: function (selector) {\n\t\t\t\t\t\treturn simpleCart.$(this.el.find(selector));\n\t\t\t\t\t},\n\t\t\t\t\tclosest: function (selector) {\n\t\t\t\t\t\treturn simpleCart.$(this.el.closest(selector));\n\t\t\t\t\t},\n\t\t\t\t\ttag: function () {\n\t\t\t\t\t\treturn this.el[0].tagName;\n\t\t\t\t\t},\n\t\t\t\t\tdescendants: function () {\n\t\t\t\t\t\treturn simpleCart.$(this.el.find(\"*\"));\n\t\t\t\t\t},\n\t\t\t\t\tsubmit: function() {\n\t\t\t\t\t\treturn this.el.submit();\n\t\t\t\t\t},\n\n\t\t\t\t\tcreate: function (selector) {\n\t\t\t\t\t\tthis.el = $engine(selector);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\tsimpleCart.ELEMENT._ = simpleCart.ELEMENT.prototype;\n\n\t\t\t// bind the DOM setup to the ready event\n\t\t\tsimpleCart.ready(simpleCart.setupViewTool);\n\n\t\t\t// bind the input and output events\n\t\t\tsimpleCart.ready(function () {\n\t\t\t\tsimpleCart.bindOutlets({\n\t\t\t\t\ttotal: function () {\n\t\t\t\t\t\treturn simpleCart.toCurrency(simpleCart.total());\n\t\t\t\t\t}\n\t\t\t\t\t, quantity: function () {\n\t\t\t\t\t\treturn simpleCart.quantity();\n\t\t\t\t\t}\n\t\t\t\t\t, items: function (selector) {\n\t\t\t\t\t\tsimpleCart.writeCart(selector);\n\t\t\t\t\t}\n\t\t\t\t\t, tax: function () {\n\t\t\t\t\t\treturn simpleCart.toCurrency(simpleCart.tax());\n\t\t\t\t\t}\n\t\t\t\t\t, taxRate: function () {\n\t\t\t\t\t\treturn simpleCart.taxRate().toFixed();\n\t\t\t\t\t}\n\t\t\t\t\t, shipping: function () {\n\t\t\t\t\t\treturn simpleCart.toCurrency(simpleCart.shipping());\n\t\t\t\t\t}\n\t\t\t\t\t, grandTotal: function () {\n\t\t\t\t\t\treturn simpleCart.toCurrency(simpleCart.grandTotal());\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tsimpleCart.bindInputs([\n\t\t\t\t\t{\t  selector: 'checkout'\n\t\t\t\t\t\t, event: 'click'\n\t\t\t\t\t\t, callback: function () {\n\t\t\t\t\t\t\tsimpleCart.checkout();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t, {\t  selector: 'empty'\n\t\t\t\t\t\t, event: 'click'\n\t\t\t\t\t\t, callback: function () {\n\t\t\t\t\t\t\tsimpleCart.empty();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t, {\t  selector: 'increment'\n\t\t\t\t\t\t, event: 'click'\n\t\t\t\t\t\t, callback: function () {\n\t\t\t\t\t\t\tsimpleCart.find(simpleCart.$(this).closest('.itemRow').attr('id').split(\"_\")[1]).increment();\n\t\t\t\t\t\t\tsimpleCart.update();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t, {\t  selector: 'decrement'\n\t\t\t\t\t\t, event: 'click'\n\t\t\t\t\t\t, callback: function () {\n\t\t\t\t\t\t\tsimpleCart.find(simpleCart.$(this).closest('.itemRow').attr('id').split(\"_\")[1]).decrement();\n\t\t\t\t\t\t\tsimpleCart.update();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t/* remove from cart */\n\t\t\t\t\t, {\t  selector: 'remove'\n\t\t\t\t\t\t, event: 'click'\n\t\t\t\t\t\t, callback: function () {\n\t\t\t\t\t\t\tsimpleCart.find(simpleCart.$(this).closest('.itemRow').attr('id').split(\"_\")[1]).remove();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t/* cart inputs */\n\t\t\t\t\t, {\t  selector: 'input'\n\t\t\t\t\t\t, event: 'change'\n\t\t\t\t\t\t, callback: function () {\n\t\t\t\t\t\t\tvar $input = simpleCart.$(this),\n\t\t\t\t\t\t\t\t$parent = $input.parent(),\n\t\t\t\t\t\t\t\tclassList = $parent.attr('class').split(\" \");\n\t\t\t\t\t\t\tsimpleCart.each(classList, function (klass) {\n\t\t\t\t\t\t\t\tif (klass.match(/item-.+/i)) {\n\t\t\t\t\t\t\t\t\tvar field = klass.split(\"-\")[1];\n\t\t\t\t\t\t\t\t\tsimpleCart.find($parent.closest('.itemRow').attr('id').split(\"_\")[1]).set(field,$input.val());\n\t\t\t\t\t\t\t\t\tsimpleCart.update();\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t/* here is our shelfItem add to cart button listener */\n\t\t\t\t\t, { selector: 'shelfItem .item_add'\n\t\t\t\t\t\t, event: 'click'\n\t\t\t\t\t\t, callback: function () {\n\t\t\t\t\t\t\tvar $button = simpleCart.$(this),\n\t\t\t\t\t\t\t\tfields = {};\n\n\t\t\t\t\t\t\t$button.closest(\".\" + namespace + \"_shelfItem\").descendants().each(function (x,item) {\n\t\t\t\t\t\t\t\tvar $item = simpleCart.$(item);\n\n\t\t\t\t\t\t\t\t// check to see if the class matches the item_[fieldname] pattern\n\t\t\t\t\t\t\t\tif ($item.attr(\"class\") &&\n\t\t\t\t\t\t\t\t\t$item.attr(\"class\").match(/item_.+/) &&\n\t\t\t\t\t\t\t\t\t!$item.attr('class').match(/item_add/)) {\n\n\t\t\t\t\t\t\t\t\t// find the class name\n\t\t\t\t\t\t\t\t\tsimpleCart.each($item.attr('class').split(' '), function (klass) {\n\t\t\t\t\t\t\t\t\t\tvar attr,\n\t\t\t\t\t\t\t\t\t\t\tval,\n\t\t\t\t\t\t\t\t\t\t\ttype;\n\n\t\t\t\t\t\t\t\t\t\t// get the value or text depending on the tagName\n\t\t\t\t\t\t\t\t\t\tif (klass.match(/item_.+/)) {\n\t\t\t\t\t\t\t\t\t\t\tattr = klass.split(\"_\")[1];\n\t\t\t\t\t\t\t\t\t\t\tval = \"\";\n\t\t\t\t\t\t\t\t\t\t\tswitch($item.tag().toLowerCase()) {\n\t\t\t\t\t\t\t\t\t\t\t\tcase \"input\":\n\t\t\t\t\t\t\t\t\t\t\t\tcase \"textarea\":\n\t\t\t\t\t\t\t\t\t\t\t\tcase \"select\":\n\t\t\t\t\t\t\t\t\t\t\t\t\ttype = $item.attr(\"type\");\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (!type || ((type.toLowerCase() === \"checkbox\" || type.toLowerCase() === \"radio\") && $item.attr(\"checked\")) || type.toLowerCase() === \"text\" || type.toLowerCase() === \"number\") {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tval = $item.val();\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\t\t\tcase \"img\":\n\t\t\t\t\t\t\t\t\t\t\t\t\tval = $item.attr('src');\n\t\t\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\t\t\t\t\t\tval = $item.text();\n\t\t\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\tif (val !== null && val !== \"\") {\n\t\t\t\t\t\t\t\t\t\t\t\tfields[attr.toLowerCase()] = fields[attr.toLowerCase()] ? fields[attr.toLowerCase()] + \", \" +  val : val;\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t// add the item\n\t\t\t\t\t\t\tsimpleCart.add(fields);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t]);\n\t\t\t});\n\n\n\t\t\t/*******************************************************************\n\t\t\t *\tDOM READY\n\t\t\t *******************************************************************/\n\t\t\t// Cleanup functions for the document ready method\n\t\t\t// used from jQuery\n\t\t\t/*global DOMContentLoaded */\n\t\t\tif (document.addEventListener) {\n\t\t\t\twindow.DOMContentLoaded = function () {\n\t\t\t\t\tdocument.removeEventListener(\"DOMContentLoaded\", DOMContentLoaded, false);\n\t\t\t\t\tsimpleCart.init();\n\t\t\t\t};\n\n\t\t\t} else if (document.attachEvent) {\n\t\t\t\twindow.DOMContentLoaded = function () {\n\t\t\t\t\t// Make sure body exists, at least, in case IE gets a little overzealous (ticket #5443).\n\t\t\t\t\tif (document.readyState === \"complete\") {\n\t\t\t\t\t\tdocument.detachEvent(\"onreadystatechange\", DOMContentLoaded);\n\t\t\t\t\t\tsimpleCart.init();\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\t\t\t// The DOM ready check for Internet Explorer\n\t\t\t// used from jQuery\n\t\t\tfunction doScrollCheck() {\n\t\t\t\tif (simpleCart.isReady) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\ttry {\n\t\t\t\t\t// If IE is used, use the trick by Diego Perini\n\t\t\t\t\t// http://javascript.nwbox.com/IEContentLoaded/\n\t\t\t\t\tdocument.documentElement.doScroll(\"left\");\n\t\t\t\t} catch (e) {\n\t\t\t\t\tsetTimeout(doScrollCheck, 1);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// and execute any waiting functions\n\t\t\t\tsimpleCart.init();\n\t\t\t}\n\t\t\t\n\t\t\t// bind ready event used from jquery\n\t\t\tfunction sc_BindReady () {\n\n\t\t\t\t// Catch cases where $(document).ready() is called after the\n\t\t\t\t// browser event has already occurred.\n\t\t\t\tif (document.readyState === \"complete\") {\n\t\t\t\t\t// Handle it asynchronously to allow scripts the opportunity to delay ready\n\t\t\t\t\treturn setTimeout(simpleCart.init, 1);\n\t\t\t\t}\n\n\t\t\t\t// Mozilla, Opera and webkit nightlies currently support this event\n\t\t\t\tif (document.addEventListener) {\n\t\t\t\t\t// Use the handy event callback\n\t\t\t\t\tdocument.addEventListener(\"DOMContentLoaded\", DOMContentLoaded, false);\n\n\t\t\t\t\t// A fallback to window.onload, that will always work\n\t\t\t\t\twindow.addEventListener(\"load\", simpleCart.init, false);\n\n\t\t\t\t// If IE event model is used\n\t\t\t\t} else if (document.attachEvent) {\n\t\t\t\t\t// ensure firing before onload,\n\t\t\t\t\t// maybe late but safe also for iframes\n\t\t\t\t\tdocument.attachEvent(\"onreadystatechange\", DOMContentLoaded);\n\n\t\t\t\t\t// A fallback to window.onload, that will always work\n\t\t\t\t\twindow.attachEvent(\"onload\", simpleCart.init);\n\n\t\t\t\t\t// If IE and not a frame\n\t\t\t\t\t// continually check to see if the document is ready\n\t\t\t\t\tvar toplevel = false;\n\n\t\t\t\t\ttry {\n\t\t\t\t\t\ttoplevel = window.frameElement === null;\n\t\t\t\t\t} catch (e) {}\n\n\t\t\t\t\tif (document.documentElement.doScroll && toplevel) {\n\t\t\t\t\t\tdoScrollCheck();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// bind the ready event\n\t\t\tsc_BindReady();\n\n\t\t\treturn simpleCart;\n\t\t};\n\n\n\twindow.simpleCart = generateSimpleCart();\n\n}(window, document));\n\n/************ JSON *************/\nvar JSON;JSON||(JSON={});\n(function () {function k(a) {return a<10?\"0\"+a:a}function o(a) {p.lastIndex=0;return p.test(a)?'\"'+a.replace(p,function (a) {var c=r[a];return typeof c===\"string\"?c:\"\\\\u\"+(\"0000\"+a.charCodeAt(0).toString(16)).slice(-4)})+'\"':'\"'+a+'\"'}function l(a,j) {var c,d,h,m,g=e,f,b=j[a];b&&typeof b===\"object\"&&typeof b.toJSON===\"function\"&&(b=b.toJSON(a));typeof i===\"function\"&&(b=i.call(j,a,b));switch(typeof b) {case \"string\":return o(b);case \"number\":return isFinite(b)?String(b):\"null\";case \"boolean\":case \"null\":return String(b);case \"object\":if (!b)return\"null\";\ne += n;f=[];if (Object.prototype.toString.apply(b)===\"[object Array]\") {m=b.length;for (c=0;c<m;c += 1)f[c]=l(c,b)||\"null\";h=f.length===0?\"[]\":e?\"[\\n\"+e+f.join(\",\\n\"+e)+\"\\n\"+g+\"]\":\"[\"+f.join(\",\")+\"]\";e=g;return h}if (i&&typeof i===\"object\") {m=i.length;for (c=0;c<m;c += 1)typeof i[c]===\"string\"&&(d=i[c],(h=l(d,b))&&f.push(o(d)+(e?\": \":\":\")+h))}else for (d in b)Object.prototype.hasOwnProperty.call(b,d)&&(h=l(d,b))&&f.push(o(d)+(e?\": \":\":\")+h);h=f.length===0?\"{}\":e?\"{\\n\"+e+f.join(\",\\n\"+e)+\"\\n\"+g+\"}\":\"{\"+f.join(\",\")+\n\"}\";e=g;return h}}if (typeof Date.prototype.toJSON!==\"function\")Date.prototype.toJSON=function () {return isFinite(this.valueOf())?this.getUTCFullYear()+\"-\"+k(this.getUTCMonth()+1)+\"-\"+k(this.getUTCDate())+\"T\"+k(this.getUTCHours())+\":\"+k(this.getUTCMinutes())+\":\"+k(this.getUTCSeconds())+\"Z\":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function () {return this.valueOf()};var q=/[\\u0000\\u00ad\\u0600-\\u0604\\u070f\\u17b4\\u17b5\\u200c-\\u200f\\u2028-\\u202f\\u2060-\\u206f\\ufeff\\ufff0-\\uffff]/g,\np=/[\\\\\\\"\\x00-\\x1f\\x7f-\\x9f\\u00ad\\u0600-\\u0604\\u070f\\u17b4\\u17b5\\u200c-\\u200f\\u2028-\\u202f\\u2060-\\u206f\\ufeff\\ufff0-\\uffff]/g,e,n,r={\"\\u0008\":\"\\\\b\",\"\\t\":\"\\\\t\",\"\\n\":\"\\\\n\",\"\\u000c\":\"\\\\f\",\"\\r\":\"\\\\r\",'\"':'\\\\\"',\"\\\\\":\"\\\\\\\\\"},i;if (typeof JSON.stringify!==\"function\")JSON.stringify=function (a,j,c) {var d;n=e=\"\";if (typeof c===\"number\")for (d=0;d<c;d += 1)n += \" \";else typeof c===\"string\"&&(n=c);if ((i=j)&&typeof j!==\"function\"&&(typeof j!==\"object\"||typeof j.length!==\"number\"))throw Error(\"JSON.stringify\");return l(\"\",\n{\"\":a})};if (typeof JSON.parse!==\"function\")JSON.parse=function (a,e) {function c(a,d) {var g,f,b=a[d];if (b&&typeof b===\"object\")for (g in b)Object.prototype.hasOwnProperty.call(b,g)&&(f=c(b,g),f!==void 0?b[g]=f:delete b[g]);return e.call(a,d,b)}var d,a=String(a);q.lastIndex=0;q.test(a)&&(a=a.replace(q,function (a) {return\"\\\\u\"+(\"0000\"+a.charCodeAt(0).toString(16)).slice(-4)}));if (/^[\\],:{}\\s]*$/.test(a.replace(/\\\\(?:[\"\\\\\\/bfnrt]|u[0-9a-fA-F]{4})/g,\"@\").replace(/\"[^\"\\\\\\n\\r]*\"|true|false|null|-?\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d+)?/g,\n\"]\").replace(/(?:^|:|,)(?:\\s*\\[)+/g,\"\")))return d=eval(\"(\"+a+\")\"),typeof e===\"function\"?c({\"\":d},\"\"):d;throw new SyntaxError(\"JSON.parse\");}})();\n\n\n/************ HTML5 Local Storage Support *************/\n(function () {if (!this.localStorage)if (this.globalStorage)try {this.localStorage=this.globalStorage}catch(e) {}else{var a=document.createElement(\"div\");a.style.display=\"none\";document.getElementsByTagName(\"head\")[0].appendChild(a);if (a.addBehavior) {a.addBehavior(\"#default#userdata\");var d=this.localStorage={length:0,setItem:function (b,d) {a.load(\"localStorage\");b=c(b);a.getAttribute(b)||this.length++;a.setAttribute(b,d);a.save(\"localStorage\")},getItem:function (b) {a.load(\"localStorage\");b=c(b);return a.getAttribute(b)},\nremoveItem:function (b) {a.load(\"localStorage\");b=c(b);a.removeAttribute(b);a.save(\"localStorage\");this.length=0},clear:function () {a.load(\"localStorage\");for (var b=0;attr=a.XMLDocument.documentElement.attributes[b++];)a.removeAttribute(attr.name);a.save(\"localStorage\");this.length=0},key:function (b) {a.load(\"localStorage\");return a.XMLDocument.documentElement.attributes[b]}},c=function (a) {return a.replace(/[^-._0-9A-Za-z\\xb7\\xc0-\\xd6\\xd8-\\xf6\\xf8-\\u037d\\u37f-\\u1fff\\u200c-\\u200d\\u203f\\u2040\\u2070-\\u218f]/g,\n\"-\")};a.load(\"localStorage\");d.length=a.XMLDocument.documentElement.attributes.length}}})();\n"]},"metadata":{},"sourceType":"module"}